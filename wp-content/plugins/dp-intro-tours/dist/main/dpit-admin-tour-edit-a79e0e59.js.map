{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack:///./node_modules/autosize/dist/autosize.js","webpack:///./includes/assets/js/modules/DpitHooks.js","webpack:///./admin/assets/js/modules/DPTourEditCTAs.js","webpack:///./admin/assets/js/modules/DPProPromoButton.js","webpack:///./admin/assets/js/modules/DPAcfAdjust.js","webpack:///./admin/assets/js/modules/AcfTippy.js","webpack:///./admin/assets/js/modules/AcfTableHtmlComps.js","webpack:///./admin/assets/js/modules/ContainerDragger.js","webpack:///./admin/assets/js/modules/AcfTableField.js","webpack:///./admin/assets/js/dpit-admin-tour-edit.js","webpack:///./includes/assets/js/modules/BulletsAnimation.js","webpack:///./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack:///./admin/assets/js/modules/dp-admin-utils.js","webpack:///./includes/assets/js/modules/DpTinyMceDialog.js","webpack:///./includes/assets/js/modules/DpWpLinkQuery.js","webpack:///./includes/assets/js/modules/DpWpLinkRiver.js","webpack:///./includes/assets/js/modules/DpWpLink.js","webpack:///./includes/assets/js/modules/DPIncUtils.js"],"names":["_toConsumableArray","arr","Array","isArray","arrayLikeToArray","iter","Symbol","iterator","from","unsupportedIterableToArray","TypeError","_arrayLikeToArray","len","length","i","arr2","module","exports","keys","values","map","Map","has","key","indexOf","get","set","value","push","delete","index","splice","createEvent","name","Event","bubbles","e","evt","document","initEvent","assign","ta","nodeName","style","heightOffset","clientWidth","cachedHeight","pageResize","update","destroy","window","removeEventListener","Object","forEach","bind","height","resize","overflowY","overflowX","wordWrap","addEventListener","getComputedStyle","boxSizing","parseFloat","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth","isNaN","changeOverflow","width","offsetWidth","scrollHeight","overflows","el","parentNode","Element","scrollTop","node","getParentOverflows","docTop","documentElement","styleHeight","Math","round","computed","actualHeight","offsetHeight","dispatchEvent","err","methods","autosize","options","prototype","call","x","default","DpitHooks","actions","filters","init","dpDebugEn","console","log","addAction","tag","callback","priority","addFilter","removeAction","filter","removeFilter","doAction","args","hook","hooks","applyFilters","res","DPTourEditCTAs","config","_this","_classCallCheck","_defineProperty","checkRelatedPostsUrlForButtonsClickability","isPRO","$","on","setTimeout","adjustVisualBuilderButtons","siteUrl","srcId","redirectQueryString","postId","expirationS","jSrcBtn","dataToPost","transientData","isGlobalStartAtAllPagesSet","bulletsAnimation","createAndRun","addClass","axios","post","urlJoin","restApiUrl","headers","nonces","wp_rest","then","trigger","catch","error","AxiosError","removeClass","this","insertConfigStepsVisuallyButton","attr","addTriggerSelectorButton","text","i18n","permalink_title","adjustReloadButtonsClickAbility","isUrlVariableProcessingEnabled","getRelatedPostsJEl","printTourId","scrollToElementByUrlAndAnimate","queryParamsDefs","_createClass","append","concat","tour_id","tourId","event","jLi","target","closest","remove","_this2","queryString","getRedirectUrlQueryString","setSelectorsBtnHtml","configure_steps_visually","set_first_step_url_PRO","set_first_step_url_FREE","set_example_vars_first","or_set_adjust_man_in_tab","BulletsAnimation","hasClass","scrollToRelatedPostsEl","data","setPostTransient","preventDefault","stopPropagation","val","keyCode","elSel","scrollToElementAndAnimate","acfGroupDataName","triggerIdx","_this3","adjustButtonVisibility","jTriggerObjectTarget","wrapperId","fadeIn","fadeOut","inputId","jSelectorInput","jTriggerObjectInputSelector","buttonId","getTriggerButtonId","setTriggerSelectorHtml","set_trigger_selector_visually","or_set_man","before","DPProPromoButton","promoBtnHtml","proDemoLink","proCTAText","DPAcfAdjust","AcfTippy","afterLoaderFinishedCb","arguments","undefined","each","idx","element","jDescElement","find","jAcfField","jMsgElement","descText","html","iconClass","DPIncUtils","getInfoIconHtml","children","add","hide","stepDefinitions","hint","title","interactive","tippy","content","reference","getAttribute","animation","theme","allowHTML","zIndex","load","assetsUrl","afterLoaderFinished","AcfTableHtmlComps","btn_small","btn_very_small","btn_very_very_small","btn_add_row","btn_add_col","btn_remove_row","btn_remove_col","htmlButtons","add_row","classes","remove_row","add_col","remove_col","add_link","remove_link","body_row","top_cell","bottom_cell","table","isEmptyObject","text_styles","label","extraClass","join","extraSettings","extraSettingsHtml","extra_data","row","linkClass","items","split","item","body_cell_link_sub_item","body_cell","checked","checkedAttr","optionCfg","valLabel","selected","visible","jQuery","_classNames","esWrapperClass","classNames","id","_item$val2","type","_item$val","minAttr","min","maxAttr","max","stepAttr","step","def","ContainerDragger","containerElement","handlerSelector","dragPos","left","containerEl","jContainerEl","jDragAndDropHandler","cursorOrig","cursor","cursorHandlerOrig","setDraggingInProcess","onMouseDown","onMouseMove","onMouseUp","onContainerResize","isContainerScrollable","isDragging","adjustCursor","userSelect","css","containerWidth","paddingLeft","parseInt","paddingRight","paddingX","scrollWidth","scrollLeft","clientX","dx","require","AcfTableField","jBody","var","ajax","columIds","state","current_cell_obj","cell_editor_cell","cell_editor_last_keycode","version","dpWpLink","DpWpLink","tableHtml","that","parent","jExtraCont","is","rebuild_table_data","activeLinkCell","linkAttrs","getAttrs","href","jSubEl","urlVarExamples","simpleObjectToStr","returnValue","each_table","table_add_col_event","table_remove_col","table_add_row_event","table_remove_row","table_add_link","table_remove_link","simple_cell_editor","link_editor","tmce_cell_editor","cell_editor_tab_navigation","prevent_cell_links","sortable_row","sortable_col","ui_event_use_header","ui_event_caption","ui_event_new_flex_field","ui_event_change_location_rule","ui_event_ajax","editor_custom_style","ajaxComplete","containerDraggers","_","_this4","interval","setInterval","clearInterval","_this5","not","p","obj_root","data_get","data_default","field_options_get","table_render","misc_render","b","c","refresh","field_options","parseJSON","decodeURIComponent","use_header","_this6","parents","obj_table","o","uh","update_table_data_field","ca","_this7","sortable","unbind","field_context","replace","_typeof","data_defaults","acftf","v","h","extend","_this8","obj_top_row","obj_top_insert","obj_header_row","obj_header_insert","obj_bottom_row","obj_bottom_insert","table_top_labels","_this$config$stepDefi","definitionId","trim","headerCellLabels","includes","definition","allowedColumnsIdx","Number","header_cell","body_rows","row_i","row_insert","cellData","get_column_html","colIdx","rowIdx","jRow","_this$config$stepDefi2","_dataVal$ext","_dataVal$ext$build_wi","columnId","stepDef","extraClasses","extClassStr","dataVal","decodeStepParamAdvancedVal","ext","build_with_wp_editor","body_cell_link","body_cell_select","body_cell_checkbox","init_option_use_header","init_option_caption","obj_use_header","use_caption","obj_caption","_this9","obj_col","table_add_col","_this10","that_index","after","show","table_build_json","_this11","obj_rows","cols_count","obj_top","table_add_row","obj_row","_this12","col_amount","body_cells_html","obj_table_rows","size","cellContent","_this$config$stepDefi3","next","table_left_labels","_this13","jUl","_this14","_this15","rows_count","letter_i_1","charCodeAt","letter_i_2","use_2","string","String","fromCharCode","jContItem","contItemSelector","resArr","n","clone","end","_this$config$stepDefi4","_this$config$stepDefi5","_this16","extCfg","getStepExtCfg","mainVal","getTableBodyCellContValAtomic","extVal","encodeStepParamAdvancedVal","_this17","i2","element_row","getTableBodyCellContVal","update_table_data_version","JSON","stringify","encodeURIComponent","field_changed","_this18","tmce","DpTinyMceDialog","currentRow","prop","jTargetContentEl","open","getStepIdx","_this$config","setTextStyles","_this19","openDpWpLink","stepIdx","urlVarExamplesStr","strToSimpleObject","sysUrlVars","_this20","stopImmediatePropagation","cell_editor_save","cell_editor_add_editor","jTarget","that_val","cell_editor_is_open","prepend","htmleditor","focus","textAreaElement","setSelectionRange","next_cell","first","no_header","prev_cell","prev","row_selectors","last","root","cell_editor","cell_editor_textarea","cell_editor_val","_this21","which","get_prev_table_cell","get_next_table_cell","ui","param","axis","containment","handle","helper","sortable_fix_width","cancel","start","start_index","end_index","sort_cols","change","header_row","header_row_children","body_row_children","ready","dpIntroToursAdminTourEditConfig","acf","acfTable","_objectSpread","ui_init_drag_to_scroll","containerSelector","bulletsClasses","count","clockPeriodMs","backward","containerLayerOverride","jOverlayLayer","jBullets","bullet4Animation","createBullets","appendChild","startReloadingSpinnerBack","startReloadingSpinner","bulletsLayer","createElement","opacity","display","ulContainer","innerLi","stopReloadSpinner","spinnerInterval","bulletHideTimeout","clearTimeout","activateBullet","_unsupportedIterableToArray","minLen","toString","slice","constructor","test","urlParamIdOfElementId","urlParamIdOfCanceled","addHighlightClass","currentUrl","URL","location","originHashIdVal","getDpUrlParam","canceled","jEl","addHighlihtClass","adminBarHeight","outerHeight","body","animate","offset","top","innerHeight","scrollParent","_getScrollParent","_scrollParentToElement","builderMode","hashId","origin","params","dp_qpb_builder_mode","dp_qpb_builder_origin","dp_qpb_origin_el_id","dp_qp_tour_id","dp_qp_run_always_on_load","dp_qp_trigger_id","buildDpQueryString","isVisualBuilderReadyPRO","firstStepUrl","globalStartAtAllPages","outData","isVariableUrl","origUrl","allVarExamplesAreSet","enableUrlVariables","every","exploreStartUrl","jFirstStepUrlCell","jFirstStepUrlCellContent","url","_isGlobalStartAtAllPagesSet","relatedPosts","adjustVisualBuilderButtonsRaw","jButton","isReady","testOutData","fadeTimeMs","jAdminBarViewLinkEl","jAdminBarViewEl","jPermalinkEl","jSlugBox","resUrl","fillUrlVariables","sanitizePossibleRelativeUrl","slugText","inactive","excludeStaticParent","position","overflowRegex","parentElement","overflow","offsetTop","offsetLeft","onTmceSaved","onTmceCancel","tinyMCE","activeEditor","getContent","close","keydown","modalOpened","getNthStr","hadDpitRelPos","editor","setContent","format","selection","select","getBody","collapse","wasCanceled","DpWpLinkQuery","search","page","allLoaded","querying","self","query","action","_dp_wplink_nonce","ajaxUrl","r","DpWpLinkRiver","ul","contentHeight","waiting","func","delay","timeoutTriggered","funcTriggered","funcArgs","funcContext","apply","posts","deselect","li","liHeight","elHeight","liTop","elTop","to","minRiverAJAXDuration","inputs","response","delayedCallback","results","process","_search","list","alt","firstPage","isFirstStep","printPostTypeItem","keepPreviousStepUrl","permalink","info","variableLink","infoLong","keepPreviousStepUrlLngInfo","keepCurrentUrl","keepCurrentUrlLngInfo","allowedPostTypes","allowedPostTypesInPagePostURL","loadAllPostTypes","toLowerCase","disabledPostTypes","noMatchesFound","additionalClass","startsWith","noTitle","maybeLoad","bottom","riverBottomThreshold","newTop","newBottom","timeToTriggerRiver","scroll","varId","tagName","currentVal","insertAt","charAt","unifiedSiteUrl","unifyUrl","wrap","dialog","backdrop","submit","nonce","openInNewTab","rivers","recent","elements","queryNotice","queryNoticeTextDefault","queryNoticeTextHint","keyup","click","updateFields","searchTimer","searchInternalLinks","updateAfterUrlChanged","correctURL","loadTippy","removeTrailingSlashes","regExp","unifiedUrl","forceQMarkWithoutSlash","activate","correctedURL","sanitizedUrl","sanitizeUrl","_ref","_document$documentEle","_document","_document$documentEle2","_document2","_document2$body","openHidden","closeAfterSubmit","enableUrlVarExamples","startScrollTop","modalOpen","urlVars","sysUrlVarsTmp","setUrlExamples","setDefaultValues","wasSubmited","force","activateSubmitButtonSpinner","getUrlExamples","htmlUpdate","attrs","parser","protocol","isOnTypingEvent","renderUrlVarExTimeout","renderUrlVarItems","nonActiveUrlVarExamples","varIds","getUrlVarIdsFromUrl","excludeSysVars","regex","matches","match","exec","vars","sysUrlVarsLength","unshift","off","onUrlVarClick","isSystemVar","idAndVal","jUrlVarItem","getUrlVarExampleHtml","jNextItem","getCustomVariables","urlExamples","isSystem","itemClass","updateSubmitButton","updateVariableUrlsGUI","beginIsEnough","stop","save","minInputLength","lastSearch","fn","shiftKey","activeElement","keyInterval","keySensitivity","replaceString","obj","separator","valueNameSeparator","str","parts","className","delimiter","dataParts","pos","substring","qMarkIdx","mainSiteUrl","forceSlashBeforeQMark","filterQMarkWithNoSlash","parameter","urlparts","prefix","pars","lastIndexOf","parameters","paramKeys","removeURLParameter","getDpUrlParamName","removeQuery","removeHash","prependSlash","strLastPart","strFirstPart","endsWith","rightTrimByString","queryParamsDefinitions","defVal","searchParams","postfixAmpersand","unmappedParams","idsUm","ids","setDpUrlParam","substr","paramName","stepDefs","mainValOnlyForSimpleVal","onlyValForExtProps","defMain","dataObj","_dataObj$val","_dataObj","dataObjStr","atob","parse","_dataObj$ext$id","_dataObj2","_dataObj2$ext","_extCfg$id","_dataObj$ext$id2","_dataObj3","_dataObj3$ext","_extCfg$id2","_stepDefs$paramName","btoa","extVals","extName","supEnabled","supStart","supEnd","$key","rootDivEl","textStylesCfg","mobileBreakPoint","mobSizeCoef","mobile_size_coef","setProperty","all_in_1_size_coef","_text_styles$font_siz","setMobileSizeCoef","font_size_unit","cssVariables","propName","textStylesIsFontFamilyVal","p_font_size","p_mb","h2_font_size","h5_font_size","unit","unitCnt","h2_mb","h5_mb","percentVal","mainCfg","instanceCreatorFce","createNew","tours","mainCfgProcessed","builderOrigin","originHashId","triggerId","initState","inNewWindow","mobileAltStepMode","tourCfg"],"mappings":"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","file":"main/dpit-admin-tour-edit-a79e0e59.js","sourcesContent":["import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}","/*!\n\tautosize 4.0.4\n\tlicense: MIT\n\thttp://www.jacklmoore.com/autosize\n*/(function(global,factory){if(typeof define===\"function\"&&define.amd){define(['module','exports'],factory);}else if(typeof exports!==\"undefined\"){factory(module,exports);}else{var mod={exports:{}};factory(mod,mod.exports);global.autosize=mod.exports;}})(this,function(module,exports){'use strict';var map=typeof Map===\"function\"?new Map():function(){var keys=[];var values=[];return{has:function has(key){return keys.indexOf(key)>-1;},get:function get(key){return values[keys.indexOf(key)];},set:function set(key,value){if(keys.indexOf(key)===-1){keys.push(key);values.push(value);}},delete:function _delete(key){var index=keys.indexOf(key);if(index>-1){keys.splice(index,1);values.splice(index,1);}}};}();var createEvent=function createEvent(name){return new Event(name,{bubbles:true});};try{new Event('test');}catch(e){// IE does not support `new Event()`\ncreateEvent=function createEvent(name){var evt=document.createEvent('Event');evt.initEvent(name,true,false);return evt;};}function assign(ta){if(!ta||!ta.nodeName||ta.nodeName!=='TEXTAREA'||map.has(ta))return;var heightOffset=null;var clientWidth=null;var cachedHeight=null;function init(){var style=window.getComputedStyle(ta,null);if(style.resize==='vertical'){ta.style.resize='none';}else if(style.resize==='both'){ta.style.resize='horizontal';}if(style.boxSizing==='content-box'){heightOffset=-(parseFloat(style.paddingTop)+parseFloat(style.paddingBottom));}else{heightOffset=parseFloat(style.borderTopWidth)+parseFloat(style.borderBottomWidth);}// Fix when a textarea is not on document body and heightOffset is Not a Number\nif(isNaN(heightOffset)){heightOffset=0;}update();}function changeOverflow(value){{// Chrome/Safari-specific fix:\n// When the textarea y-overflow is hidden, Chrome/Safari do not reflow the text to account for the space\n// made available by removing the scrollbar. The following forces the necessary text reflow.\nvar width=ta.style.width;ta.style.width='0px';// Force reflow:\n/* jshint ignore:start */ta.offsetWidth;/* jshint ignore:end */ta.style.width=width;}ta.style.overflowY=value;}function getParentOverflows(el){var arr=[];while(el&&el.parentNode&&el.parentNode instanceof Element){if(el.parentNode.scrollTop){arr.push({node:el.parentNode,scrollTop:el.parentNode.scrollTop});}el=el.parentNode;}return arr;}function resize(){if(ta.scrollHeight===0){// If the scrollHeight is 0, then the element probably has display:none or is detached from the DOM.\nreturn;}var overflows=getParentOverflows(ta);var docTop=document.documentElement&&document.documentElement.scrollTop;// Needed for Mobile IE (ticket #240)\nta.style.height='';ta.style.height=ta.scrollHeight+heightOffset+'px';// used to check if an update is actually necessary on window.resize\nclientWidth=ta.clientWidth;// prevents scroll-position jumping\noverflows.forEach(function(el){el.node.scrollTop=el.scrollTop;});if(docTop){document.documentElement.scrollTop=docTop;}}function update(){resize();var styleHeight=Math.round(parseFloat(ta.style.height));var computed=window.getComputedStyle(ta,null);// Using offsetHeight as a replacement for computed.height in IE, because IE does not account use of border-box\nvar actualHeight=computed.boxSizing==='content-box'?Math.round(parseFloat(computed.height)):ta.offsetHeight;// The actual height not matching the style height (set via the resize method) indicates that \n// the max-height has been exceeded, in which case the overflow should be allowed.\nif(actualHeight<styleHeight){if(computed.overflowY==='hidden'){changeOverflow('scroll');resize();actualHeight=computed.boxSizing==='content-box'?Math.round(parseFloat(window.getComputedStyle(ta,null).height)):ta.offsetHeight;}}else{// Normally keep overflow set to hidden, to avoid flash of scrollbar as the textarea expands.\nif(computed.overflowY!=='hidden'){changeOverflow('hidden');resize();actualHeight=computed.boxSizing==='content-box'?Math.round(parseFloat(window.getComputedStyle(ta,null).height)):ta.offsetHeight;}}if(cachedHeight!==actualHeight){cachedHeight=actualHeight;var evt=createEvent('autosize:resized');try{ta.dispatchEvent(evt);}catch(err){// Firefox will throw an error on dispatchEvent for a detached element\n// https://bugzilla.mozilla.org/show_bug.cgi?id=889376\n}}}var pageResize=function pageResize(){if(ta.clientWidth!==clientWidth){update();}};var destroy=function(style){window.removeEventListener('resize',pageResize,false);ta.removeEventListener('input',update,false);ta.removeEventListener('keyup',update,false);ta.removeEventListener('autosize:destroy',destroy,false);ta.removeEventListener('autosize:update',update,false);Object.keys(style).forEach(function(key){ta.style[key]=style[key];});map.delete(ta);}.bind(ta,{height:ta.style.height,resize:ta.style.resize,overflowY:ta.style.overflowY,overflowX:ta.style.overflowX,wordWrap:ta.style.wordWrap});ta.addEventListener('autosize:destroy',destroy,false);// IE9 does not fire onpropertychange or oninput for deletions,\n// so binding to onkeyup to catch most of those events.\n// There is no way that I know of to detect something like 'cut' in IE9.\nif('onpropertychange'in ta&&'oninput'in ta){ta.addEventListener('keyup',update,false);}window.addEventListener('resize',pageResize,false);ta.addEventListener('input',update,false);ta.addEventListener('autosize:update',update,false);ta.style.overflowX='hidden';ta.style.wordWrap='break-word';map.set(ta,{destroy:destroy,update:update});init();}function destroy(ta){var methods=map.get(ta);if(methods){methods.destroy();}}function update(ta){var methods=map.get(ta);if(methods){methods.update();}}var autosize=null;// Do nothing in Node.js environment and IE8 (or lower)\nif(typeof window==='undefined'||typeof window.getComputedStyle!=='function'){autosize=function autosize(el){return el;};autosize.destroy=function(el){return el;};autosize.update=function(el){return el;};}else{autosize=function autosize(el,options){if(el){Array.prototype.forEach.call(el.length?el:[el],function(x){return assign(x,options);});}return el;};autosize.destroy=function(el){if(el){Array.prototype.forEach.call(el.length?el:[el],destroy);}return el;};autosize.update=function(el){if(el){Array.prototype.forEach.call(el.length?el:[el],update);}return el;};}exports.default=autosize;module.exports=exports['default'];});","\r\n/**\r\n * DpitHooks object\r\n *\r\n * This object needs to be declared early so that it can be used in code.\r\n * Preferably at a global scope.\r\n */\r\nif (!window.DpitHooks) window.DpitHooks = {};\r\n//DpitHooks = window.DpitHooks || {}; // Extend Hooks if exists or create new Hooks object.\r\nDpitHooks.actions = DpitHooks.actions || {}; // Registered actions\r\nDpitHooks.filters = DpitHooks.filters || {}; // Registered filters\r\n\r\n\r\nDpitHooks.init = function (dpDebugEn) {\r\n\tDpitHooks.dpDebugEn = dpDebugEn;\r\n\tif (dpDebugEn) console.log('DpitHooks.init');\r\n};\r\n/**\r\n  * Add a new Action callback to DpitHooks.actions\r\n  *\r\n  * @param tag The tag specified by doAction()\r\n  * @param callback The callback function to call when do_action() is called\r\n  * @param priority The order in which to call the callbacks. Default: 10 (like WordPress)\r\n  */\r\nDpitHooks.addAction = function (tag, callback, priority) {\r\n\tif (typeof priority === 'undefined') {\r\n\t\tpriority = 10;\r\n\t}\r\n\r\n\t// If the tag doesn't exist, create it.\r\n\tDpitHooks.actions[tag] = DpitHooks.actions[tag] || [];\r\n\tDpitHooks.actions[tag].push({ priority, callback });\r\n};\r\n\r\n/**\r\n  * Add a new Filter callback to DpitHooks.filters\r\n  *\r\n  * @param tag The tag specified by applyFilters()\r\n  * @param callback The callback function to call when apply_filters() is called\r\n  * @param priority Priority of filter to apply. Default: 10 (like WordPress)\r\n  */\r\nDpitHooks.addFilter = function (tag, callback, priority) {\r\n\tif (typeof priority === 'undefined') {\r\n\t\tpriority = 10;\r\n\t}\r\n\r\n\t// If the tag doesn't exist, create it.\r\n\tDpitHooks.filters[tag] = DpitHooks.filters[tag] || [];\r\n\tDpitHooks.filters[tag].push({ priority, callback });\r\n};\r\n\r\n/**\r\n  * Remove an Action callback from DpitHooks.actions\r\n  *\r\n  * Must be the exact same callback signature.\r\n  * Warning: Anonymous functions can not be removed.\r\n  * @param tag The tag specified by doAction()\r\n  * @param callback The callback function to remove\r\n  */\r\nDpitHooks.removeAction = function (tag, callback) {\r\n\tDpitHooks.actions[tag] = DpitHooks.actions[tag] || [];\r\n\r\n\tDpitHooks.actions[tag].forEach((filter, i) => {\r\n\t\tif (filter.callback === callback) {\r\n\t\t\tDpitHooks.actions[tag].splice(i, 1);\r\n\t\t}\r\n\t});\r\n};\r\n\r\n/**\r\n  * Remove a Filter callback from DpitHooks.filters\r\n  *\r\n  * Must be the exact same callback signature.\r\n  * Warning: Anonymous functions can not be removed.\r\n  * @param tag The tag specified by applyFilters()\r\n  * @param callback The callback function to remove\r\n  */\r\nDpitHooks.removeFilter = function (tag, callback) {\r\n\tDpitHooks.filters[tag] = DpitHooks.filters[tag] || [];\r\n\r\n\tDpitHooks.filters[tag].forEach((filter, i) => {\r\n\t\tif (filter.callback === callback) {\r\n\t\t\tDpitHooks.filters[tag].splice(i, 1);\r\n\t\t}\r\n\t});\r\n};\r\n\r\n/**\r\n  * Calls actions that are stored in DpitHooks.actions for a specific tag or nothing\r\n  * if there are no actions to call.\r\n  *\r\n  * @param tag A registered tag in DpitHooks.actions\r\n  * @param args Optional JavaScript object to pass to the callbacks\r\n  */\r\nDpitHooks.doAction = function (tag, args) {\r\n\tconst actions = [];\r\n\tif (DpitHooks.dpDebugEn) console.log('API action - Tag:', tag, ', Subscribed count:', DpitHooks.actions[tag] ? DpitHooks.actions[tag].length : 0, ', Args:', args);\r\n\tif (typeof DpitHooks.actions[tag] !== 'undefined' && DpitHooks.actions[tag].length > 0) {\r\n\t\tDpitHooks.actions[tag].forEach((hook) => {\r\n\t\t\tactions[hook.priority] = actions[hook.priority] || [];\r\n\t\t\tactions[hook.priority].push(hook.callback);\r\n\t\t});\r\n\r\n\t\tactions.forEach((hooks) => {\r\n\t\t\thooks.forEach((callback) => {\r\n\r\n\t\t\t\tcallback(args);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n};\r\n\r\n/**\r\n  * Calls filters that are stored in DpitHooks.filters for a specific tag or return\r\n  * original value if no filters exist.\r\n  *\r\n  * @param tag A registered tag in DpitHooks.filters\r\n  * @param args Optional JavaScript object to pass to the callbacks\r\n  */\r\nDpitHooks.applyFilters = function (tag, value, args) {\r\n\tconst filters = [];\r\n\tlet res = value;\r\n\tif (DpitHooks.dpDebugEn) console.log('API filter - Tag:', tag, ', Subscribed count:', DpitHooks.filters[tag] ? DpitHooks.filters[tag].length : 0, ', Args:', args);\r\n\tif (typeof DpitHooks.filters[tag] !== 'undefined' && DpitHooks.filters[tag].length > 0) {\r\n\t\tDpitHooks.filters[tag].forEach((hook) => {\r\n\t\t\tfilters[hook.priority] = filters[hook.priority] || [];\r\n\t\t\tfilters[hook.priority].push(hook.callback);\r\n\t\t});\r\n\r\n\t\tfilters.forEach((hooks) => {\r\n\t\t\thooks.forEach((callback) => {\r\n\t\t\t\tres = callback(res, args);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\treturn res;\r\n};\r\n\r\nexport default DpitHooks;\r\n","import axios from 'axios';\r\nimport AxiosError from 'axios-error';\r\nimport urlJoin from 'url-join';\r\nimport BulletsAnimation from '../../../../includes/assets/js/modules/BulletsAnimation';\r\nimport {\r\n\tscrollToElementByUrlAndAnimate,\r\n\tscrollToElementAndAnimate,\r\n\tgetRedirectUrlQueryString,\r\n\tisUrlVariableProcessingEnabled,\r\n\tisGlobalStartAtAllPagesSet,\r\n\tadjustVisualBuilderButtons\r\n} from './dp-admin-utils';\r\n\r\n\r\nexport default class DPTourEditCTAs {\r\n\r\n\tconstructor(config) {\r\n\t\tif (config.dpDebugEn) console.log('DPTourEditCTAs');\r\n\t\tthis.config = config;\r\n\t\tthis.bulletsAnimation = [];\r\n\r\n\t\t// Set trigger selector visually\r\n\t\tthis.insertConfigStepsVisuallyButton();\r\n\r\n\t\t$('.acf-field-group[data-name=\"intro_trigger\"]').attr('id', 'dp-trigger-config-group');\r\n\t\tthis.addTriggerSelectorButton('intro_trigger', 0);\r\n\t\tif (this.config.isPRO) this.addTriggerSelectorButton('intro_trigger_2', 1);\r\n\r\n\r\n\t\t$('#edit-slug-box strong').text(this.config.i18n.permalink_title);\r\n\t\tthis.adjustReloadButtonsClickAbility();\r\n\t\t$('.acf-field[data-name=\"url_vars_examples\"] textarea').on('click', () => {\r\n\t\t\tif (isUrlVariableProcessingEnabled()) {\r\n\t\t\t\tthis.getRelatedPostsJEl().trigger('click');\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//this.initMultipleChoiceSelectLongTouch();\r\n\r\n\t\tthis.printTourId();\r\n\r\n\t\tsetTimeout(() => scrollToElementByUrlAndAnimate(this.config.queryParamsDefs), 300);\r\n\t}\r\n\r\n\tprintTourId() {\r\n\t\t$('#edit-slug-box').append(`<strong>${this.config.i18n.tour_id}: </strong><span class=\"dpit-tour-id\">${this.config.tourId}</span>`);\r\n\t}\r\n\r\n\tinitMultipleChoiceSelectLongTouch() {\r\n\t\t// to do\r\n\t\t$('.select2-selection__choice__remove').on('touchend', (event) => {\r\n\t\t\tconst jLi = $(event.target).closest('li');\r\n\t\t\tif (jLi.length) {\r\n\t\t\t\t$(jLi[0]).remove();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\r\n\tinsertConfigStepsVisuallyButton() {\r\n\t\t// Set selectors visually\r\n\t\tconst tableId = 'dp-step-table';\r\n\t\tconst queryString = getRedirectUrlQueryString(this.config.queryParamsDefs, this.config.tourId, 1, 'dp-step-table', 'admin');\r\n\t\tconst setSelectorsBtnHtml = (\r\n\t\t\t`<div class=\"dpit-admin-action\">\r\n    <div id=\"dp-config-steps-vis-btn\" role=\"button\" class=\"dpit-admin-btn dpit-admin-btn-for-reload dpit-admin-action__btn\">\r\n        <span class=\"dpit-admin-btn__text\">${this.config.i18n.configure_steps_visually}</span>\r\n        <span class=\"dpit-admin-btn__inactive-text\">${this.config.isPRO ? this.config.i18n.set_first_step_url_PRO : this.config.i18n.set_first_step_url_FREE}</span>\r\n        <span class=\"dpit-admin-btn__inactive-text-2\">${this.config.i18n.set_example_vars_first}</span>\r\n    </div>\r\n    <div class=\"dp-or-set-manually\">~ ${this.config.i18n.or_set_adjust_man_in_tab} ~</div>\r\n</div>`\r\n\t\t);\r\n\t\t$('.acf-field-table[data-name=\"intro_steps\"] .acf-label').append(setSelectorsBtnHtml);\r\n\t\t$('.acf-field-table[data-name=\"intro_steps\"] .acf-table-table').attr('id', tableId);\r\n\r\n\t\tthis.bulletsAnimation['dp-config-steps-vis-btn'] = new BulletsAnimation('#dp-config-steps-vis-btn', 'dpselectelbuttonanimation', ['dpit-admin-btn__bullets'], 8, 100);\r\n\r\n\t\t$('#dp-config-steps-vis-btn').on('click', (event) => {\r\n\t\t\tif ($('#dp-config-steps-vis-btn').hasClass('inactive')) {\r\n\t\t\t\tthis.scrollToRelatedPostsEl();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t$(event.target).data('href');\r\n\t\t\t\tthis.setPostTransient('dpintro_builder_transient', 'dp-config-steps-vis-btn', queryString, this.config.tourId, 30);\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}\r\n\r\n\tkeyboardKeyCodeInput() {\r\n\t\t$('.acf-field--key-code input').on('keydown', (event) => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tevent.stopPropagation();\r\n\t\t\t$(event.target).val(event.keyCode);\r\n\t\t});\r\n\t}\r\n\r\n\tgetRelatedPostsJEl() {\r\n\t\tconst elSel = this.config.isPRO\r\n\t\t\t? '.acf-field-table[data-name=\"intro_steps\"] .acf-table-table .acf-table-body-row:nth-child(3) .acf-table-body-cell--link'\r\n\t\t\t: '.acf-field[data-name=\"intro_trigger\"] .acf-field[data-name=\"intro_related_posts\"]';\r\n\t\treturn $(elSel);\r\n\t}\r\n\r\n\tscrollToRelatedPostsEl() {\r\n\t\tscrollToElementAndAnimate(this.getRelatedPostsJEl(), false, this.config.isPRO);\r\n\t}\r\n\r\n\tgetTriggerButtonId(acfGroupDataName, triggerIdx) {\r\n\t\treturn `${acfGroupDataName}_dp-select-trigger-btn_${triggerIdx}`;\r\n\t}\r\n\r\n\tadjustReloadButtonsClickAbility = () => {\r\n\t\tthis.checkRelatedPostsUrlForButtonsClickability();\r\n\t\tif (!this.config.isPRO) {\r\n\r\n\t\t\t$(document).on(\r\n\t\t\t\t'change',\r\n\t\t\t\t'.acf-field[data-name=\"intro_trigger\"] .acf-field[data-name=\"intro_related_posts\"] .select2-hidden-accessible',\r\n\t\t\t\t() => { setTimeout(this.checkRelatedPostsUrlForButtonsClickability, 100); }\r\n\t\t\t);\r\n\t\t}\r\n\t\telse {\r\n\t\t\t$(document).on(\r\n\t\t\t\t'mouseup',\r\n\t\t\t\t'.acf-field[data-name=\"global_start_at_all_pages\"] .acf-switch',\r\n\t\t\t\t() => {\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.checkRelatedPostsUrlForButtonsClickability();\r\n\t\t\t\t\t}, 100);\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\t$(document).on(\r\n\t\t\t\t'mouseup',\r\n\t\t\t\t'.acf-field[data-name=\"url_vars_enabled\"] .acf-switch',\r\n\t\t\t\t() => {\r\n\t\t\t\t\tsetTimeout(() => {\r\n\r\n\t\t\t\t\t\tthis.checkRelatedPostsUrlForButtonsClickability();\r\n\t\t\t\t\t}, 100);\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tcheckRelatedPostsUrlForButtonsClickability = () => {\r\n\t\tadjustVisualBuilderButtons(this.config.isPRO, this.config.siteUrl);\r\n\t}\r\n\r\n\taddTriggerSelectorButton(acfGroupDataName, triggerIdx) {\r\n\t\tconst adjustButtonVisibility = (jTriggerObjectTarget, wrapperId) => {\r\n\t\t\tif (jTriggerObjectTarget.val() == 'custom_selector') {\r\n\t\t\t\t$(`#${wrapperId}`).fadeIn();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t$(`#${wrapperId}`).fadeOut();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif ($(`.acf-field[data-name=\"${acfGroupDataName}\"]`).length) {\r\n\t\t\tconst wrapperId = `dp-select-trigger_${triggerIdx}`;\r\n\t\t\tconst inputId = `${wrapperId}_input`;\r\n\t\t\tconst jSelectorInput = $(`.acf-field[data-name=\"${acfGroupDataName}\"] .acf-field[data-name=\"intro_trigger_selector\"] .acf-input`);\r\n\t\t\tconst jTriggerObjectInputSelector = `.acf-field[data-name=\"${acfGroupDataName}\"] .acf-field[data-name=\"trigger_object\"] input`;\r\n\r\n\t\t\tjSelectorInput.attr('id', inputId);\r\n\t\t\t$(`.acf-field[data-name=\"${acfGroupDataName}\"] .acf-field[data-name=\"intro_trigger_selector\"]`).attr('id');\r\n\r\n\t\t\tconst queryString = getRedirectUrlQueryString(this.config.queryParamsDefs, this.config.tourId, 2, inputId, 'admin', triggerIdx);\r\n\r\n\t\t\tconst buttonId = this.getTriggerButtonId(acfGroupDataName, triggerIdx);\r\n\t\t\tconst setTriggerSelectorHtml = (\r\n\t\t\t\t`<div id=\"${wrapperId}\" class=\"dp-select-trigger\">\r\n    <div id=\"${buttonId}\" role=\"button\" class=\"dpit-admin-btn dpit-admin-btn--trigger dpit-admin-btn-for-reload\">\r\n        <span class=\"dpit-admin-btn__text\">${this.config.i18n.set_trigger_selector_visually}</span>\r\n        <span class=\"dpit-admin-btn__inactive-text\">${this.config.isPRO ? this.config.i18n.set_first_step_url_PRO : this.config.i18n.set_first_step_url_FREE}</span>\r\n        <span class=\"dpit-admin-btn__inactive-text-2\">${this.config.i18n.set_example_vars_first}</span>\r\n    </div>\r\n    <div class=\"dp-or-set-manually\">~ ${this.config.i18n.or_set_man} ~</div>\r\n</div>`);\r\n\t\t\tjSelectorInput.before(setTriggerSelectorHtml);\r\n\r\n\t\t\tadjustButtonVisibility($(jTriggerObjectInputSelector + ':checked'), wrapperId);\r\n\t\t\t$(jTriggerObjectInputSelector).on('change', (event) => { adjustButtonVisibility($(event.target), wrapperId); });\r\n\t\t\tthis.bulletsAnimation[buttonId] = new BulletsAnimation(`#${buttonId}`, `${buttonId}_anim`, ['dpit-admin-btn__bullets'], 8, 100);\r\n\r\n\t\t\t$(`#${buttonId}`).on('click', (event) => {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tif ($(`#${buttonId}`).hasClass('inactive')) {\r\n\t\t\t\t\tthis.scrollToRelatedPostsEl();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.setPostTransient('dpintro_builder_transient', buttonId, queryString, this.config.tourId, 30);\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tsetPostTransient = (name, srcId, redirectQueryString, postId, expirationS) => {\r\n\t\t// adjust settings in db\r\n\t\tconst jSrcBtn = $('#' + srcId);\r\n\t\tconst dataToPost = {\r\n\t\t\tname: name,\r\n\t\t\texpirationS: expirationS,\r\n\t\t\ttransientData: {\r\n\t\t\t\tpostId: postId,\r\n\t\t\t\tredirectQueryString: redirectQueryString,\r\n\t\t\t\tisGlobalStartAtAllPagesSet: isGlobalStartAtAllPagesSet() ? 1 : 0\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.bulletsAnimation[srcId].createAndRun();\r\n\t\tjSrcBtn.addClass('in-process');\r\n\t\taxios.post(\r\n\t\t\turlJoin(this.config.restApiUrl, 'dpintrotours/v1/set-transient'),\r\n\t\t\tdataToPost,\r\n\t\t\t{ headers: { 'X-WP-Nonce': this.config.nonces.wp_rest } }\r\n\t\t)\r\n\t\t\t.then(() => {\r\n\t\t\t\t$('#publishing-action #publish').trigger('click');\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tconsole.log(new AxiosError(error));\r\n\t\t\t\tjSrcBtn.removeClass('in-process');\r\n\t\t\t\tthis.bulletsAnimation[srcId].destroy();\r\n\t\t\t});\r\n\t}\r\n\r\n}","export default class DPProPromoButton {\r\n\tconstructor(config) {\r\n\t\tif (config.dpDebugEn) console.log('DPProPromoButton');\r\n\t\tthis.config = config;\r\n\t\tconst promoBtnHtml = (\r\n\t\t\t`<div class=\"dpit-admin-action\">\r\n                <a href=\"${config.proDemoLink}\" target=_blank role=\"button\" class=\"dpit-admin-btn dpit-admin-action__btn\">\r\n                    <span class=\"dpit-admin-btn__text\">${config.proCTAText}</span>\r\n                </a>\r\n            </div>`\r\n\t\t);\r\n\t\t$('.acf-field[data-name=\"intro_enabled\"]').append($(promoBtnHtml).addClass('dpit-admin-action--top'));\r\n\t\t$('.acf-field-group[data-name=\"intro_url_variables\"]>.acf-label').append(promoBtnHtml);\r\n\t}\r\n}\r\n","export default class DPAcfAdjust {\r\n\tconstructor(config) {\r\n\t\tif (config.dpDebugEn) console.log('DPAcfAdjust');\r\n\r\n\t\t$(document).on(\r\n\t\t\t'tap',\r\n\t\t\t'.acf-icon',\r\n\t\t\t(event) => {\r\n\t\t\t\t$(event.target).trigger('click');\r\n\t\t\t},\r\n\t\t);\r\n\t\t$(document).on(\r\n\t\t\t'mousedown',\r\n\t\t\t'.acf-field-relationship .values-list .acf-rel-item .acf-icon[data-name=\"remove_item\"]',\r\n\t\t\t(event) => {\r\n\t\t\t\tconsole.log('mouseDown');\r\n\t\t\t\t$(event.target).trigger('click');\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n}\r\n","\r\nimport tippy from 'tippy.js';\r\nimport urlJoin from 'url-join';\r\nimport 'tippy.js/dist/tippy.css';\r\nimport 'tippy.js/themes/material.css';\r\nimport 'tippy.js/animations/scale.css';\r\nimport DPIncUtils from '../../../../includes/assets/js/modules/DPIncUtils';\r\nimport DpitHooks from '../../../../includes/assets/js/modules/DpitHooks';\r\n\r\nexport default class AcfTippy {\r\n\r\n\tconstructor(config, afterLoaderFinishedCb = null) {\r\n\t\tif (config.dpDebugEn) console.log('AcfTippy');\r\n\t\tthis.config = config;\r\n\t\tthis.afterLoaderFinished = afterLoaderFinishedCb;\r\n\t\tthis.init();\r\n\t}\r\n\r\n\tinit = () => {\r\n\r\n\t\t$('#post-body-content .acf-field:not(.acf-field-group):not(.acf-field--no-info-icon) .acf-label').each((idx, element) => {\r\n\t\t\tconst jDescElement = $(element).find('.description');\r\n\t\t\tconst jAcfField = $(element).closest('.acf-field');\r\n\t\t\tconst jMsgElement = jAcfField.find('span.message');\r\n\t\t\tlet descText = jDescElement.html();\r\n\t\t\tlet text = jMsgElement.html() || '';\r\n\t\t\tif (text && descText) text += '<br>';\r\n\t\t\ttext += jDescElement.html() || '';\r\n\t\t\tif (text.length) {\r\n\t\t\t\tconst iconClass = jAcfField.hasClass('acf-field--ia') ? 'dp-info-icon dp-info-icon--ia' : 'dp-info-icon';\r\n\t\t\t\t$(element).addClass('acf-label--with-info-icon').append(DPIncUtils.getInfoIconHtml(iconClass, text, $(element).children('label').text()));\r\n\t\t\t\tjDescElement.add(jMsgElement).hide();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (this.config.stepDefinitions) {\r\n\r\n\t\t\tObject.keys(this.config.stepDefinitions).forEach((key) => {\r\n\t\t\t\tconst data = this.config.stepDefinitions[key];\r\n\t\t\t\tif (data.hint) {\r\n\t\t\t\t\t$('#acf-t-header-' + key).addClass('acf-table-header-cell--with-info-icon').append(DPIncUtils.getInfoIconHtml('dp-info-icon dp-info-icon--in-table-header', data.hint, data.title));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t$('.dp-info-icon').each((idx, element) => {\r\n\t\t\tvar interactive = $(element).hasClass('dp-info-icon--ia');\r\n\t\t\ttippy(element, {\r\n\t\t\t\tcontent: (reference) => reference.getAttribute('data-info-text'),\r\n\t\t\t\tanimation: 'scale',\r\n\t\t\t\ttheme: 'material',\r\n\t\t\t\tallowHTML: true,\r\n\t\t\t\tinteractive: interactive,\r\n\t\t\t\tzIndex: 100000003\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\t$('#acf-group_5e4c8efda20c2').addClass('dp-acf-tippy');\r\n\t\t\t$('.post-type-dp_intro_tours #post-body').fadeIn(700);\r\n\t\t\t$('.dp-info-icon').load(urlJoin(this.config.assetsUrl, '../../includes/assets/icons/info-circle-solid.svg'));\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\t$('#acf-intro-data-loader').fadeOut(700, () => {\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tDpitHooks.doAction('adminEditTourLoaded', {\r\n\t\t\t\t\t\t\ttourId: this.config.tourId\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (this.afterLoaderFinished) this.afterLoaderFinished();\r\n\t\t\t\t\t}, 300);\r\n\r\n\t\t\t\t});\r\n\t\t\t\t$('.dp-info-icon').fadeIn(700);\r\n\t\t\t}, 400);\r\n\t\t}, 300);\r\n\t}\r\n}","import classNames from 'classnames';\r\n\r\nexport default class AcfTableHtmlComps {\r\n\tclasses = {\r\n\t\tbtn_small: 'acf-icon acf-icon--s',\r\n\t\tbtn_very_small: 'acf-icon acf-icon--xs',\r\n\t\tbtn_very_very_small: 'acf-icon acf-icon--xxs',\r\n\t\tbtn_add_row: 'acf-icon-plus -plus',\r\n\t\tbtn_add_col: 'acf-icon-plus -plus',\r\n\t\tbtn_remove_row: 'acf-icon-minus -minus',\r\n\t\tbtn_remove_col: 'acf-icon-minus -minus',\r\n\t};\r\n\thtmleditor = (\r\n\t\t'<div class=\"acf-table-cell-editor\">'\r\n\t\t+ '<textarea name=\"acf-table-cell-editor-textarea\" class=\"acf-table-cell-editor-textarea\"></textarea>'\r\n\t\t+ '</div>');\r\n\r\n\tconstructor(config) {\r\n\t\tthis.htmlButtons = {\r\n\t\t\tadd_row: `<a href=\"#\" class=\"acf-table-add-row no-drag ${this.classes.btn_small} ${this.classes.btn_add_row}\"></a>`,\r\n\t\t\tremove_row: `<a href=\"#\" class=\"acf-table-remove-row ${this.classes.btn_small} ${this.classes.btn_remove_row}\"></a>`,\r\n\t\t\tadd_col: `<a href=\"#\" class=\"acf-table-add-col ${this.classes.btn_small} ${this.classes.btn_add_col}\"></a>`,\r\n\t\t\tremove_col: `<a href=\"#\" class=\"acf-table-remove-col ${this.classes.btn_small} ${this.classes.btn_remove_row}\"></a>`,\r\n\t\t\tadd_link: `<a href=\"#\" class=\"acf-table-add-link no-drag ${this.classes.btn_very_small} ${this.classes.btn_add_row}\"></a>`,\r\n\t\t\tremove_link: `<a href=\"#\" class=\"acf-table-remove-link no-drag ${this.classes.btn_very_very_small} ${this.classes.btn_remove_row}\"></a>`,\r\n\t\t};\r\n\r\n\t\tthis.body_row = `${'<div class=\"acf-table-body-row\">'\r\n\t\t\t+ '<div class=\"acf-table-body-left\">'}${this.htmlButtons.add_row}<div class=\"acf-table-body-left-wrap\">`\r\n\t\t\t+ '<div class=\"acf-table-body-cont\"><!--ph--></div>'\r\n\t\t\t+ '<div class=\"acf-table-sort-row-icon\"></div>'\r\n\t\t\t+ '</div>'\r\n\t\t\t+ '</div>'\r\n\t\t\t+ `<div class=\"acf-table-body-right\">${this.htmlButtons.remove_row\r\n\t\t\t}</div>`\r\n\t\t\t+ '</div>';\r\n\r\n\t\tthis.top_cell = `<div class=\"acf-table-top-cell\" data-colparam=\"\">${this.htmlButtons.add_col}<div class=\"acf-table-top-cont\"><!--ph--></div>`\r\n\t\t\t+ '</div>';\r\n\r\n\r\n\t\tthis.bottom_cell = `<div class=\"acf-table-bottom-cell\">${this.htmlButtons.remove_col}</div>`;\r\n\r\n\t\tthis.table = `<div class=\"acf-table-wrap${!$.isEmptyObject(config.text_styles) ? ' acf-table-wrap--cs' : ''}\">`\r\n\t\t\t+ '<div class=\"acf-table-table\">'\r\n\t\t\t+ '<div class=\"acf-table-top-row\">'\r\n\t\t\t+ '<div class=\"acf-table-top-left\">' + this.htmlButtons.add_col + '</div>'\r\n\t\t\t+ '<div class=\"acf-table-top-right\"></div>'\r\n\t\t\t+ '</div>'\r\n\t\t\t+ '<div class=\"acf-table-header-row acf-table-header-hide-off\">'\r\n\t\t\t+ '<div class=\"acf-table-header-left\">' + this.htmlButtons.add_row + '</div>'\r\n\t\t\t+ '<div class=\"acf-table-header-right\"></div>'\r\n\t\t\t+ '</div>'\r\n\t\t\t+ '<div class=\"acf-table-bottom-row\">'\r\n\t\t\t+ '<div class=\"acf-table-bottom-left\"></div>'\r\n\t\t\t+ '<div class=\"acf-table-bottom-right\"></div>'\r\n\t\t\t+ '</div>'\r\n\t\t\t+ '</div>'\r\n\t\t\t+ '</div>';\r\n\r\n\t}\r\n\r\n\theader_cell(label, extraClass, value) {\r\n\t\tconst classes = ['acf-table-header-cell'];\r\n\t\tif (extraClass) classes.push(extraClass);\r\n\t\treturn (\r\n\t\t\t`<div class=\"${classes.join(' ')}\"${value ? ` id=\"acf-t-header-${value}\"` : ''}>\r\n\t\t\t\t<div class=\"acf-table-header-cont\" data-val=\"${value}\">${label}</div>\r\n\t\t\t</div>`\r\n\t\t);\r\n\t}\r\n\r\n\tbody_cell(value = '', extraClass = null, extraSettings = null) {\r\n\t\tlet extraSettingsHtml = this.extra_data(extraSettings, true);\r\n\t\tconst classes = ['acf-table-body-cell'];\r\n\t\tif (extraClass) classes.push(extraClass);\r\n\t\treturn `<div class=\"${classes.join(' ')}\">`\r\n\t\t\t+ `<div class=\"acf-table-body-cont\">${value}${extraSettingsHtml}</div>`\r\n\t\t\t+ '</div>';\r\n\t}\r\n\r\n\tbody_cell_link(value = '', extraClass = null, extraSettings = null, row = 0) {\r\n\t\tlet linkClass = '';\r\n\t\tif (row === 0) {\r\n\t\t\tlinkClass += ' acf-table-body-cell--link-multi';\r\n\t\t\tconst items = value.split(',').filter(i => i);\r\n\t\t\tvalue = '<ul>';\r\n\t\t\tif (items && items.length) {\r\n\t\t\t\titems.forEach(item => {\r\n\t\t\t\t\tvalue += this.body_cell_link_sub_item(item);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tvalue += '</ul>';\r\n\t\t\tvalue += this.htmlButtons.add_link;\r\n\t\t}\r\n\t\tif (extraClass) extraClass += ' ';\r\n\t\treturn this.body_cell(value, extraClass + linkClass, extraSettings);\r\n\t}\r\n\r\n\tbody_cell_link_sub_item(value = '') {\r\n\t\treturn `<li class=\"acf-table-body-cont-li\"><span>${value}</span>${this.htmlButtons.remove_link}</li>`;\r\n\t}\r\n\r\n\tbody_cell_checkbox(checked = false, extraClass = null, extraSettings = null) {\r\n\t\tlet extraSettingsHtml = this.extra_data(extraSettings, checked);\r\n\r\n\t\tconst classes = ['acf-table-body-cell'];\r\n\t\tif (extraClass) classes.push(extraClass);\r\n\t\tconst checkedAttr = checked ? ' checked' : '';\r\n\t\treturn `<div class=\"${classes.join(' ')}\">`\r\n\t\t\t+ '<div class=\"acf-table-body-cont acf-table-body-cont--checkbox\">'\r\n\t\t\t+ `<input type=\"checkbox\" class=\"acf-table-body-cont-sub\"${checkedAttr}>`\r\n\t\t\t+ extraSettingsHtml\r\n\t\t\t+ '</div>'\r\n\t\t\t+ '</div>';\r\n\t}\r\n\r\n\tbody_cell_select(options, value, extraClass) {\r\n\t\tconst classes = ['acf-table-body-cont-sub'];\r\n\t\tif (extraClass) classes.push(extraClass);\r\n\t\treturn '<div class=\"acf-table-body-cell\">'\r\n\t\t\t+ '<div class=\"acf-table-body-cont acf-table-body-cont--select\">'\r\n\t\t\t+ `<select class=\"${classes.join(' ')}\">`\r\n\t\t\t+ options.map((optionCfg) => {\r\n\t\t\t\tconst valLabel = optionCfg.split(':');\r\n\t\t\t\tconst val = valLabel[0];\r\n\t\t\t\tconst label = valLabel.length > 1 ? valLabel[1] : valLabel[0];\r\n\t\t\t\tconst selected = (val == value) ? ' selected=\"selected\"' : '';\r\n\t\t\t\treturn `<option value=\"${val}\"${selected}>${label}</option>`;\r\n\t\t\t}).join('')\r\n\t\t\t+ '</select>'\r\n\t\t\t+ '</div>'\r\n\t\t\t+ '</div>';\r\n\t}\r\n\r\n\textra_data(extraSettings, visible) {\r\n\t\tlet extraSettingsHtml = '';\r\n\t\tif (extraSettings && !jQuery.isEmptyObject(extraSettings)) {\r\n\t\t\tconst esWrapperClass = classNames({\r\n\t\t\t\t['acf-table-cell-ec']: true,\r\n\t\t\t\t['acf-table-cell-ec--hidden']: !visible\r\n\t\t\t});\r\n\t\t\textraSettingsHtml += `<div class=\"${esWrapperClass}\">`;\r\n\t\t\tObject.keys(extraSettings).forEach(id => {\r\n\t\t\t\tconst item = extraSettings[id];\r\n\r\n\t\t\t\tif (item.title) extraSettingsHtml += `<div class=\"acf-cell-eci-wrap\" data-id=\"${id}\">`;\r\n\t\t\t\tswitch (item.type) {\r\n\t\t\t\t\tcase 'checkbox': extraSettingsHtml += `<input type=\"checkbox\" class=\"acf-table-body-cont-sub\"${item.val == 1 ? ' checked' : ''}>`; break;\r\n\t\t\t\t\tcase 'number':\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tconst minAttr = item.min !== undefined && item.min !== null ? ` min=\"${item.min}\"` : '';\r\n\t\t\t\t\t\t\tconst maxAttr = item.max !== undefined && item.max !== null ? ` max=\"${item.max}\"` : '';\r\n\t\t\t\t\t\t\tconst stepAttr = item.step !== undefined && item.step !== null ? ` step=\"${item.step}\"` : '';\r\n\t\t\t\t\t\t\textraSettingsHtml += `<input type=\"number\"${minAttr}${maxAttr}${stepAttr} class=\"acf-table-body-cont-sub\" value=\"${item.val ?? item.def}\">`;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: extraSettingsHtml += `<input type=\"text\" class=\"acf-table-body-cont-sub\" value=\"${item.val ?? item.def}\">`; break;\r\n\t\t\t\t}\r\n\t\t\t\tif (item.title) extraSettingsHtml += `<span>${item.title}</span></div>`;\r\n\t\t\t});\r\n\t\t\textraSettingsHtml += '</div>';\r\n\t\t}\r\n\t\treturn extraSettingsHtml;\r\n\t}\r\n\r\n}","export default class ContainerDragger {\r\n\tconstructor(containerElement, handlerSelector) {\r\n\t\tthis.dragPos = {\r\n\t\t\tx: null,\r\n\t\t\tleft: null\r\n\t\t};\r\n\r\n\r\n\t\tthis.containerEl = containerElement;\r\n\t\tthis.jContainerEl = $(containerElement);\r\n\t\tthis.jDragAndDropHandler = this.jContainerEl.find(handlerSelector);\r\n\r\n\t\tthis.cursorOrig = this.containerEl.style.cursor;\r\n\t\tif (this.jDragAndDropHandler.length) {\r\n\t\t\tthis.cursorHandlerOrig = this.jDragAndDropHandler[0].style.cursor;\r\n\t\t}\r\n\r\n\t\tthis.setDraggingInProcess(false);\r\n\r\n\t\tthis.jDragAndDropHandler.on('mousedown', this.onMouseDown.bind(this));\r\n\t\tdocument.addEventListener('mousemove', this.onMouseMove.bind(this));\r\n\t\tdocument.addEventListener('mouseup', this.onMouseUp.bind(this));\r\n\t\t$(window).on('resize', this.onContainerResize.bind(this));\r\n\r\n\t}\r\n\r\n\tsetDraggingInProcess(val) {\r\n\t\tconst isContainerScrollable = this.isContainerScrollable();\r\n\t\tthis.isDragging = isContainerScrollable ? val : false;\r\n\t\tthis.adjustCursor(isContainerScrollable);\r\n\t}\r\n\r\n\trefresh() {\r\n\t\tthis.adjustCursor(this.isContainerScrollable());\r\n\t}\r\n\r\n\r\n\tadjustCursor(isContainerScrollable) {\r\n\r\n\t\tif (!this.isDragging) {\r\n\t\t\tthis.containerEl.style.cursor = this.cursorOrig;\r\n\t\t\tthis.containerEl.style.userSelect = '';\r\n\t\t\tif (isContainerScrollable) this.jDragAndDropHandler.css('cursor', 'grab');\r\n\t\t\telse if (this.jDragAndDropHandler) this.jDragAndDropHandler.css('cursor', this.cursorHandlerOrig);\r\n\t\t}\r\n\t\telse if (isContainerScrollable) {\r\n\t\t\tthis.containerEl.style.cursor = 'grabbing';\r\n\t\t\tthis.containerEl.style.userSelect = 'none';\r\n\t\t\tthis.jDragAndDropHandler.css('cursor', 'grabbing');\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tonContainerResize() {\r\n\t\tthis.setDraggingInProcess(false);\r\n\t}\r\n\r\n\tisContainerScrollable() {\r\n\t\tconst containerWidth = this.jContainerEl.width();\r\n\t\tconst paddingLeft = parseInt(window.getComputedStyle(this.containerEl)['padding-left'], 10);\r\n\t\tconst paddingRight = parseInt(window.getComputedStyle(this.containerEl)['padding-right'], 10);\r\n\t\tlet paddingX = 0;\r\n\t\tif (!isNaN(paddingLeft)) paddingX += paddingLeft;\r\n\t\tif (!isNaN(paddingRight)) paddingX += paddingRight;\r\n\t\treturn (this.containerEl.scrollWidth - paddingX - 1) > containerWidth;\r\n\t}\r\n\r\n\tonMouseDown(e) {\r\n\t\tthis.dragPos = {\r\n\t\t\tleft: this.containerEl.scrollLeft,\r\n\t\t\tx: e.clientX\r\n\t\t};\r\n\t\tthis.setDraggingInProcess(true);\r\n\t}\r\n\r\n\tonMouseUp() {\r\n\t\tif (this.isDragging) {\r\n\t\t\tthis.setDraggingInProcess(false);\r\n\t\t}\r\n\t}\r\n\r\n\tonMouseMove(e) {\r\n\t\tif (this.isDragging) {\r\n\t\t\t// How far the mouse has been moved\r\n\t\t\tconst dx = e.clientX - this.dragPos.x;\r\n\t\t\t// Scroll the element\r\n\t\t\tthis.containerEl.scrollLeft = this.dragPos.left - dx;\r\n\t\t}\r\n\t}\r\n\r\n}","import urlJoin from 'url-join';\r\nimport DPIncUtils from '../../../../includes/assets/js/modules/DPIncUtils';\r\nimport DpTinyMceDialog from '../../../../includes/assets/js/modules/DpTinyMceDialog';\r\n\r\nimport {\r\n\tisUrlVariableProcessingEnabled,\r\n\tadjustVisualBuilderButtons,\r\n} from './dp-admin-utils';\r\n\r\nimport DpWpLink from '../../../../includes/assets/js/modules/DpWpLink';\r\nimport AcfTableHtmlComps from './AcfTableHtmlComps';\r\nimport ContainerDragger from './ContainerDragger';\r\nconst autosize = require('autosize');\r\n\r\n\r\nexport default class AcfTableField {\r\n\tallowedColumnsIdx = [];\r\n\r\n\tconstructor(config) {\r\n\t\tif (config.dpDebugEn) console.log('ACFTableField config:', config);\r\n\t\tthis.config = config;\r\n\t\tthis.jBody = $('body');\r\n\t\tthis.var = {\r\n\t\t\tajax: false,\r\n\t\t\tcolumIds: [],\r\n\t\t};\r\n\t\tthis.state = {\r\n\t\t\tcurrent_cell_obj: false,\r\n\t\t\tcell_editor_cell: false,\r\n\t\t\tcell_editor_last_keycode: false\r\n\t\t};\r\n\r\n\t\tthis.version = config.version ? config.version : '1.4.0';\r\n\t\tif (config.dpWpLink) this.dpWpLink = new DpWpLink(config.dpWpLink);\r\n\t\tthis.tableHtml = new AcfTableHtmlComps(this.config);\r\n\r\n\r\n\t\tthis.jBody.on('click blur', '.acf-table-body-cont--checkbox .acf-table-body-cont-sub', (e) => {\r\n\t\t\tconst that = $(e.target).closest('.acf-table-body-cont--checkbox .acf-table-body-cont-sub');\r\n\t\t\tthis.state.current_cell_obj = $(that.closest('.acf-table-body-cell')[0]) || false;\r\n\t\t\tif (!that.parent('.acf-cell-eci-wrap').length) {\r\n\t\t\t\tconst jExtraCont = this.state.current_cell_obj.find('.acf-table-cell-ec');\r\n\t\t\t\tif ($(that[0]).is(':checked')) jExtraCont.removeClass('acf-table-cell-ec--hidden');\r\n\t\t\t\telse jExtraCont.addClass('acf-table-cell-ec--hidden');\r\n\t\t\t}\r\n\t\t\tthis.rebuild_table_data(that);\r\n\t\t});\r\n\r\n\r\n\t\t$(document).on('dpwplink-canceled', () => {\r\n\t\t\tif (this.state.current_cell_obj && this.dpWpLink) {\r\n\t\t\t\tthis.state.current_cell_obj.find('.acf-table-body-cont .acf-table-body-cont-li span:empty').closest('.acf-table-body-cont-li').remove();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$('body').on('click', '#dp_wp-link-submit', (e) => {\r\n\t\t\tif (this.state.current_cell_obj && this.dpWpLink) {\r\n\t\t\t\tconst activeLinkCell = this.state.current_cell_obj.find('.acf-table-body-cont')[0];\r\n\t\t\t\tif (activeLinkCell) {\r\n\t\t\t\t\tconst linkAttrs = this.dpWpLink.getAttrs();\r\n\t\t\t\t\tconst { href, jSubEl } = linkAttrs;\r\n\t\t\t\t\tconst row = this.state.current_cell_obj.closest('.acf-table-body-row').find('.acf-table-body-left .acf-table-body-cont').text();\r\n\r\n\t\t\t\t\tif (jSubEl && jSubEl.length) jSubEl.text(href || '');\r\n\t\t\t\t\telse $(activeLinkCell).text(href || '');\r\n\r\n\t\t\t\t\tif (row == '1') {\r\n\t\t\t\t\t\tif (linkAttrs.urlVarExamples) {\r\n\t\t\t\t\t\t\t$('.acf-field[data-name=\"url_vars_examples\"] textarea').val(DPIncUtils.simpleObjectToStr(linkAttrs.urlVarExamples, '\\n'));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tadjustVisualBuilderButtons(true, this.config.siteUrl);\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tthis.rebuild_table_data(activeLinkCell);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// trap any events\r\n\t\t\te.preventDefault ? e.preventDefault() : e.returnValue = false;\r\n\t\t\te.stopPropagation();\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\t\tthis.jBody.on('click', '.acf-table-body-cont--select .acf-table-body-cont-sub', (e) => {\r\n\t\t\tconst that = $(e.target).closest('.acf-table-body-cont--select .acf-table-body-cont-sub');\r\n\t\t\tthis.state.current_cell_obj = $(that.closest('.acf-table-body-cell')[0]) || false;\r\n\t\t\tthis.rebuild_table_data(that);\r\n\t\t});\r\n\t\tthis.init();\r\n\t}\r\n\r\n\tinit() {\r\n\t\tthis.each_table();\r\n\t\tthis.table_add_col_event();\r\n\t\tthis.table_remove_col();\r\n\t\tthis.table_add_row_event();\r\n\t\tthis.table_remove_row();\r\n\t\tthis.table_add_link();\r\n\t\tthis.table_remove_link();\r\n\t\tthis.simple_cell_editor();\r\n\t\tthis.link_editor();\r\n\t\tthis.tmce_cell_editor();\r\n\r\n\t\tthis.cell_editor_tab_navigation();\r\n\t\tthis.prevent_cell_links();\r\n\t\tthis.sortable_row();\r\n\t\tthis.sortable_col();\r\n\t\tthis.ui_event_use_header();\r\n\t\tthis.ui_event_caption();\r\n\t\tthis.ui_event_new_flex_field();\r\n\t\tthis.ui_event_change_location_rule();\r\n\t\tthis.ui_event_ajax();\r\n\t\tthis.editor_custom_style();\r\n\t}\r\n\r\n\tui_event_ajax() {\r\n\t\t$(document).ajaxComplete(() => {\r\n\t\t\tthis.each_table();\r\n\t\t});\r\n\t}\r\n\r\n\tui_init_drag_to_scroll() {\r\n\t\tthis.containerDraggers = {};\r\n\t\t$('.acf-table-wrap').each((_, element) => {\r\n\t\t\tthis.containerDraggers[element] = new ContainerDragger(element, '.acf-table-header-cell');\r\n\t\t});\r\n\t}\r\n\r\n\tui_event_change_location_rule() {\r\n\t\tthis.jBody.on('change', '[name=\"post_category[]\"], [name=\"post_format\"], [name=\"page_template\"], [name=\"parent_id\"], [name=\"role\"], [name^=\"tax_input\"]', () => {\r\n\t\t\tvar interval = setInterval(() => {\r\n\t\t\t\tconst table_fields = $('.field_type-table');\r\n\r\n\t\t\t\tif (table_fields.length > 0) {\r\n\t\t\t\t\tthis.each_table();\r\n\r\n\t\t\t\t\tclearInterval(interval);\r\n\t\t\t\t}\r\n\t\t\t}, 100);\r\n\t\t});\r\n\t}\r\n\r\n\teach_table() {\r\n\t\t$('.acf-field-table .acf-table-root').not('.acf-table-rendered').each((_, element) => {\r\n\t\t\tconst p = {};\r\n\t\t\tp.obj_root = $(element);\r\n\t\t\tconst table = p.obj_root.find('.acf-table-wrap');\r\n\r\n\t\t\tif (table.length > 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tp.obj_root.addClass('acf-table-rendered');\r\n\r\n\t\t\tthis.data_get(p);\r\n\r\n\t\t\tthis.data_default(p);\r\n\r\n\t\t\tthis.field_options_get(p);\r\n\r\n\t\t\tthis.table_render(p);\r\n\r\n\t\t\tthis.misc_render(p);\r\n\r\n\t\t\tif (typeof p.data.b[1] === 'undefined' && typeof p.data.b[0][1] === 'undefined' && p.data.b[0][0].c === '') {\r\n\t\t\t\tp.obj_root.find('.acf-table-remove-col').hide();\r\n\t\t\t\tp.obj_root.find('.acf-table-remove-row').hide();\r\n\t\t\t}\r\n\t\t\tif (this.containerDraggers && this.containerDraggers[element]) {\r\n\t\t\t\tthis.containerDraggers[element].refresh();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tfield_options_get(p) {\r\n\t\ttry {\r\n\t\t\tp.field_options = $.parseJSON(decodeURIComponent(p.obj_root.find('[data-field-options]').data('field-options')));\r\n\t\t} catch (e) {\r\n\t\t\tp.field_options = {\r\n\t\t\t\tuse_header: 2,\r\n\t\t\t};\r\n\r\n\t\t\tconsole.log('The tablefield options value is not a valid JSON string:', decodeURIComponent(p.obj_root.find('[data-field-options]').data('field-options')));\r\n\t\t\tconsole.log('The parsing error:', e);\r\n\t\t}\r\n\t}\r\n\r\n\tui_event_use_header() {\r\n\t\t// HEADER: SELECT FIELD ACTIONS {\r\n\r\n\t\tthis.jBody.on('change', '.acf-table-fc-opt-use-header', (e) => {\r\n\t\t\tconst that = $(e.target).closest('.acf-table-fc-opt-use-header');\r\n\t\t\tconst p = {};\r\n\r\n\t\t\tp.obj_root = that.parents('.acf-table-root');\r\n\t\t\tp.obj_table = p.obj_root.find('.acf-table-table');\r\n\r\n\t\t\tthis.data_get(p);\r\n\r\n\t\t\tthis.data_default(p);\r\n\r\n\t\t\tif (that.val() === '1') {\r\n\t\t\t\tp.obj_table.removeClass('acf-table-hide-header');\r\n\r\n\t\t\t\tp.data.p.o.uh = 1;\r\n\t\t\t\tthis.update_table_data_field(p);\r\n\t\t\t} else {\r\n\t\t\t\tp.obj_table.addClass('acf-table-hide-header');\r\n\r\n\t\t\t\tp.data.p.o.uh = 0;\r\n\t\t\t\tthis.update_table_data_field(p);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// }\r\n\t}\r\n\r\n\tui_event_caption() {\r\n\t\t// CAPTION: INPUT FIELD ACTIONS {\r\n\r\n\t\tthis.jBody.on('change', '.acf-table-fc-opt-caption', function (e) {\r\n\t\t\tconst that = $(e.target).closest('.acf-table-fc-opt-caption');\r\n\t\t\tconst p = {};\r\n\r\n\t\t\tp.obj_root = that.parents('.acf-table-root');\r\n\t\t\tp.obj_table = p.obj_root.find('.acf-table-table');\r\n\r\n\t\t\tthis.data_get(p);\r\n\t\t\tthis.data_default(p);\r\n\r\n\t\t\tp.data.p.ca = that.val();\r\n\t\t\tthis.update_table_data_field(p);\r\n\t\t});\r\n\r\n\t\t// }\r\n\t}\r\n\r\n\tui_event_new_flex_field() {\r\n\t\tthis.jBody.on('click', '.acf-fc-popup', () => {\r\n\t\t\t// SORTABLE {\r\n\r\n\t\t\t$('.acf-table-table')\r\n\t\t\t\t.sortable('destroy')\r\n\t\t\t\t.unbind();\r\n\r\n\t\t\twindow.setTimeout(() => {\r\n\t\t\t\tthis.sortable_row();\r\n\t\t\t}, 300);\r\n\r\n\t\t\t// }\r\n\t\t});\r\n\t}\r\n\r\n\tdata_get(p) {\r\n\t\t// DATA FROM FIELD {\r\n\r\n\t\tconst val = p.obj_root.find('input.table').val();\r\n\r\n\t\tp.data = false;\r\n\r\n\t\t// CHECK FIELD CONTEXT {\r\n\r\n\t\tif (p.obj_root.closest('.acf-fields').hasClass('acf-block-fields')) {\r\n\t\t\tp.field_context = 'block';\r\n\t\t} else {\r\n\t\t\tp.field_context = 'box';\r\n\t\t}\r\n\r\n\t\t// }\r\n\r\n\t\tif (val !== '') {\r\n\t\t\ttry {\r\n\t\t\t\tif (p.field_context === 'box') {\r\n\t\t\t\t\tp.data = $.parseJSON(decodeURIComponent(val.replace(/\\+/g, '%20')));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (p.field_context === 'block') {\r\n\t\t\t\t\tp.data = $.parseJSON(decodeURIComponent(val.replace(/\\+/g, '%20')));\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tif (p.field_context === 'box') {\r\n\t\t\t\t\tconsole.log('The parsing error:', e);\r\n\t\t\t\t\tconsole.log('The tablefield value is not a valid JSON string:', decodeURIComponent(val.replace(/\\+/g, '%20')));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (p.field_context === 'block') {\r\n\t\t\t\t\tconsole.log('The parsing error:', e);\r\n\t\t\t\t\tconsole.log('The tablefield value is not a valid JSON string:', decodeURIComponent(val.replace(/\\+/g, '%20')));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (typeof p.data.p !== 'object') {\r\n\t\t\t\tconsole.log('The tablefield value is not a tablefield JSON string:', p.data);\r\n\r\n\t\t\t\tp.data = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn p.data;\r\n\r\n\t\t// }\r\n\t}\r\n\r\n\tdata_default(p) {\r\n\t\t// DEFINE DEFAULT DATA {\r\n\r\n\t\tp.data_defaults = {\r\n\r\n\t\t\tacftf: {\r\n\t\t\t\tv: this.version,\r\n\t\t\t},\r\n\r\n\t\t\tp: {\r\n\t\t\t\to: {\r\n\t\t\t\t\tuh: 0, // use header\r\n\t\t\t\t},\r\n\t\t\t\tca: '', // caption content\r\n\t\t\t},\r\n\r\n\t\t\t// from data-colparam\r\n\r\n\t\t\tc: [\r\n\t\t\t\t{\r\n\t\t\t\t\tc: '',\r\n\t\t\t\t},\r\n\t\t\t],\r\n\r\n\t\t\t// header\r\n\r\n\t\t\th: [\r\n\t\t\t\t{\r\n\t\t\t\t\tc: '',\r\n\t\t\t\t},\r\n\t\t\t],\r\n\r\n\t\t\t// body\r\n\r\n\t\t\tb: [\r\n\t\t\t\t[\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tc: '',\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t],\r\n\t\t};\r\n\r\n\t\t// }\r\n\r\n\t\t// MERGE DEFAULT DATA {\r\n\r\n\t\tif (p.data) {\r\n\t\t\tconst typePDB = typeof p.data.b;\r\n\t\t\tif (typePDB === 'array') {\r\n\t\t\t\t$.extend(true, p.data, p.data_defaults);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tp.data = p.data_defaults;\r\n\t\t}\r\n\r\n\t\t// }\r\n\t}\r\n\r\n\ttable_render(p) {\r\n\t\t// TABLE HTML MAIN {\r\n\r\n\t\tp.obj_root.find('.acf-table-wrap').remove();\r\n\t\tp.obj_root.append(this.tableHtml.table);\r\n\r\n\t\t// }\r\n\r\n\t\t// TABLE GET OBJECTS {\r\n\r\n\t\tp.obj_table = p.obj_root.find('.acf-table-table');\r\n\t\tp.obj_top_row = p.obj_root.find('.acf-table-top-row');\r\n\t\tp.obj_top_insert = p.obj_top_row.find('.acf-table-top-right');\r\n\t\tp.obj_header_row = p.obj_root.find('.acf-table-header-row');\r\n\t\tp.obj_header_insert = p.obj_header_row.find('.acf-table-header-right');\r\n\t\tp.obj_bottom_row = p.obj_root.find('.acf-table-bottom-row');\r\n\t\tp.obj_bottom_insert = p.obj_bottom_row.find('.acf-table-bottom-right');\r\n\r\n\t\t// }\r\n\r\n\t\t// TOP CELLS {\r\n\r\n\t\tif (p.data.c) {\r\n\t\t\tfor (var i in p.data.c) {\r\n\t\t\t\tp.obj_top_insert.before(this.tableHtml.top_cell);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.table_top_labels(p);\r\n\r\n\t\t// }\r\n\r\n\t\t// HEADER CELLS {\r\n\r\n\t\tif (p.data.h) {\r\n\t\t\tfor (i in p.data.h) {\r\n\t\t\t\tconst definitionId = p.data.h[i].v.replace(/xxx&quot/g, '\"').trim();\r\n\t\t\t\tlet headerCellLabels = p.data.h[i].c.replace(/xxx&quot/g, '\"').trim();\r\n\t\t\t\tthis.var.columIds.push(definitionId);\r\n\t\t\t\tlet extraClass = '';\r\n\r\n\t\t\t\tif (Object.keys(this.config.stepDefinitions).includes(definitionId) && !this.config.stepDefinitions[definitionId]?.hide) {\r\n\t\t\t\t\tconst definition = this.config.stepDefinitions[definitionId];\r\n\t\t\t\t\tif (definition) {\r\n\t\t\t\t\t\tthis.allowedColumnsIdx.push(Number(i));\r\n\t\t\t\t\t\theaderCellLabels = definition.title;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\textraClass = 'dp-hidden';\r\n\t\t\t\t}\r\n\t\t\t\tp.obj_header_insert.before(this.tableHtml.header_cell(headerCellLabels, extraClass, definitionId));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// }\r\n\r\n\t\t// BODY ROWS {\r\n\r\n\t\tif (p.data.b) {\r\n\t\t\tfor (i in p.data.b) {\r\n\t\t\t\tp.obj_bottom_row.before(this.tableHtml.body_row.replace('<!--ph-->', parseInt(i) + 1));\r\n\t\t\t}\r\n\t\t\t$('.acf-table-sort-row-icon').load(urlJoin(this.config.assetsUrl, '/icons/arrows-alt-v-solid.svg')).addClass('acf-table-sort-row-icon--loaded').fadeIn(700);\r\n\t\t}\r\n\r\n\t\t// }\r\n\r\n\t\t// BODY ROWS CELLS {\r\n\r\n\t\tconst body_rows = p.obj_root.find('.acf-table-body-row');\r\n\t\tlet row_i = 0;\r\n\r\n\t\tif (body_rows) {\r\n\t\t\tbody_rows.each((_, element) => {\r\n\t\t\t\tconst body_row = $(element);\r\n\t\t\t\tconst row_insert = body_row.find('.acf-table-body-right');\r\n\r\n\t\t\t\tfor (i in p.data.b[row_i]) {\r\n\t\t\t\t\tlet cellData = p.data.b[row_i][i].c;\r\n\t\t\t\t\tif (cellData) cellData = p.data.b[row_i][i].c.replace(/xxx&quot/g, '\"');\r\n\t\t\t\t\trow_insert.before(this.get_column_html(Number(i), cellData, row_i, body_row));\r\n\t\t\t\t}\r\n\r\n\t\t\t\trow_i += 1;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// }\r\n\r\n\t\t// TABLE BOTTOM {\r\n\r\n\t\tif (p.data.c) {\r\n\t\t\tfor (i in p.data.c) {\r\n\t\t\t\tp.obj_bottom_insert.before(this.tableHtml.bottom_cell);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// }\r\n\t}\r\n\r\n\tget_column_html(colIdx, data, rowIdx, jRow) {\r\n\t\tconst columnId = this.var.columIds[colIdx];\r\n\t\tconst stepDef = this.config.stepDefinitions?.[columnId];\r\n\t\tconst type = stepDef ? stepDef.type : '';\r\n\t\tlet extraClasses = [];\r\n\t\tif (!this.allowedColumnsIdx.includes(colIdx)) {\r\n\t\t\textraClasses.push('dp-hidden');\r\n\t\t}\r\n\t\textraClasses.push(`acf-table-body-cell--${type}`);\r\n\t\tconst extClassStr = extraClasses.join(' ');\r\n\r\n\t\tconst dataVal = DPIncUtils.decodeStepParamAdvancedVal(data, columnId, this.config.stepDefinitions, false);\r\n\r\n\t\tif (columnId === 'hidden_meta' && dataVal?.ext?.build_with_wp_editor?.val === '1') {\r\n\t\t\t// set white spacing class\r\n\t\t\tif (jRow) jRow.find('.acf-table-body-cell--text_wp_edit .acf-table-body-cont').addClass('acf-table-body-cont--rt');\r\n\t\t}\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase 'link': return this.tableHtml.body_cell_link(dataVal.val, extClassStr, dataVal.ext, rowIdx);\r\n\t\t\tcase 'select': return this.tableHtml.body_cell_select(stepDef.options, dataVal.val, extClassStr, dataVal.ext);\r\n\t\t\tcase 'checkbox': return this.tableHtml.body_cell_checkbox(dataVal.val === true || dataVal.val == 1, extClassStr, dataVal.ext);\r\n\t\t\tdefault: return this.tableHtml.body_cell(dataVal.val, extClassStr, dataVal.ext);\r\n\t\t}\r\n\t}\r\n\r\n\tmisc_render(p) {\r\n\t\tthis.init_option_use_header(p);\r\n\t\tthis.init_option_caption(p);\r\n\t}\r\n\r\n\tinit_option_use_header(p) {\r\n\t\t// VARS {\r\n\r\n\t\tconst v = {};\r\n\r\n\t\tv.obj_use_header = p.obj_root.find('.acf-table-fc-opt-use-header');\r\n\r\n\t\t// }\r\n\r\n\t\t// HEADER {\r\n\r\n\t\t// HEADER: FIELD OPTIONS, THAT AFFECTS DATA {\r\n\r\n\t\t// HEADER IS NOT ALLOWED\r\n\r\n\t\tif (p.field_options.use_header === 2) {\r\n\t\t\tp.obj_table.addClass('acf-table-hide-header');\r\n\r\n\t\t\tp.data.p.o.uh = 0;\r\n\t\t\tthis.update_table_data_field(p);\r\n\t\t}\r\n\r\n\t\t// HEADER IS REQUIRED\r\n\r\n\t\tif (p.field_options.use_header === 1) {\r\n\t\t\tp.data.p.o.uh = 1;\r\n\t\t\tthis.update_table_data_field(p);\r\n\t\t}\r\n\r\n\t\t// }\r\n\r\n\t\t// HEADER: SET CHECKBOX STATUS {\r\n\r\n\t\tif (p.data.p.o.uh === 1) {\r\n\t\t\tv.obj_use_header.val('1');\r\n\t\t}\r\n\r\n\t\tif (p.data.p.o.uh === 0) {\r\n\t\t\tv.obj_use_header.val('0');\r\n\t\t}\r\n\r\n\t\t// }\r\n\r\n\t\t// HEADER: SET HEADER VISIBILITY {\r\n\r\n\t\tif (p.data.p.o.uh === 1) {\r\n\t\t\tp.obj_table.removeClass('acf-table-hide-header');\r\n\t\t}\r\n\r\n\t\tif (p.data.p.o.uh === 0) {\r\n\t\t\tp.obj_table.addClass('acf-table-hide-header');\r\n\t\t}\r\n\r\n\t\t// }\r\n\r\n\t\t// }\r\n\t}\r\n\r\n\tinit_option_caption(p) {\r\n\t\tif (\r\n\t\t\ttypeof p.field_options.use_caption !== 'number'\r\n\t\t\t|| p.field_options.use_caption === 2\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// VARS {\r\n\r\n\t\tconst v = {};\r\n\r\n\t\tv.obj_caption = p.obj_root.find('.acf-table-fc-opt-caption');\r\n\r\n\t\t// }\r\n\r\n\t\t// SET CAPTION VALUE {\r\n\r\n\t\tv.obj_caption.val(p.data.p.ca);\r\n\r\n\t\t// }\r\n\t}\r\n\r\n\ttable_add_col_event() {\r\n\t\tthis.jBody.on('click', '.acf-table-add-col', (e) => {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tconst that = $(e.target).closest('.acf-table-add-col');\r\n\t\t\tconst p = {};\r\n\r\n\t\t\tp.obj_col = that.parent();\r\n\r\n\t\t\tthis.table_add_col(p);\r\n\t\t});\r\n\t}\r\n\r\n\ttable_add_col(p) {\r\n\t\t// requires\r\n\t\t// p.obj_col\r\n\r\n\t\tconst that_index = p.obj_col.index();\r\n\r\n\t\tp.obj_root = p.obj_col.parents('.acf-table-root');\r\n\t\tp.obj_table = p.obj_root.find('.acf-table-table');\r\n\r\n\t\t$(p.obj_table.find('.acf-table-top-row').children()[that_index]).after(this.tableHtml.top_cell.replace('<!--ph-->', ''));\r\n\r\n\t\t$(p.obj_table.find('.acf-table-header-row').children()[that_index]).after(this.tableHtml.header_cell(''));\r\n\r\n\t\tp.obj_table.find('.acf-table-body-row').each((_, element) => {\r\n\t\t\t$($(element).children()[that_index]).after(this.tableHtml.body_cell());\r\n\t\t});\r\n\r\n\t\t$(p.obj_table.find('.acf-table-bottom-row').children()[that_index]).after(this.tableHtml.bottom_cell.replace('<!--ph-->', ''));\r\n\r\n\t\tthis.table_top_labels(p);\r\n\r\n\t\tp.obj_table.find('.acf-table-remove-col').show();\r\n\t\tp.obj_table.find('.acf-table-remove-row').show();\r\n\r\n\t\tthis.table_build_json(p);\r\n\t}\r\n\r\n\ttable_remove_col() {\r\n\t\tthis.jBody.on('click', '.acf-table-remove-col', (e) => {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tconst p = {};\r\n\t\t\tconst that = $(e.target).closest('.acf-table-remove-col');\r\n\t\t\tconst that_index = that.parent().index();\r\n\t\t\tlet obj_rows;\r\n\t\t\tlet cols_count = false;\r\n\r\n\t\t\tp.obj_root = that.parents('.acf-table-root');\r\n\t\t\tp.obj_table = p.obj_root.find('.acf-table-table');\r\n\t\t\tp.obj_top = p.obj_root.find('.acf-table-top-row');\r\n\t\t\tobj_rows = p.obj_table.find('.acf-table-body-row');\r\n\t\t\tcols_count = p.obj_top.find('.acf-table-top-cell').length;\r\n\r\n\t\t\t$(p.obj_table.find('.acf-table-top-row').children()[that_index]).remove();\r\n\r\n\t\t\t$(p.obj_table.find('.acf-table-header-row').children()[that_index]).remove();\r\n\r\n\t\t\tif (cols_count == 1) {\r\n\t\t\t\tobj_rows.remove();\r\n\r\n\t\t\t\tthis.table_add_col({\r\n\t\t\t\t\tobj_col: p.obj_table.find('.acf-table-top-left'),\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.table_add_row({\r\n\t\t\t\t\tobj_row: p.obj_table.find('.acf-table-header-row'),\r\n\t\t\t\t});\r\n\r\n\t\t\t\tp.obj_table.find('.acf-table-remove-col').hide();\r\n\t\t\t\tp.obj_table.find('.acf-table-remove-row').hide();\r\n\t\t\t} else {\r\n\t\t\t\tobj_rows.each((_, element) => {\r\n\t\t\t\t\t$($(element).children()[that_index]).remove();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t$(p.obj_table.find('.acf-table-bottom-row').children()[that_index]).remove();\r\n\r\n\t\t\tthis.table_top_labels(p);\r\n\r\n\t\t\tthis.table_build_json(p);\r\n\t\t});\r\n\t}\r\n\r\n\ttable_add_row_event() {\r\n\t\tthis.jBody.on('mouseup', '.acf-table-add-row', (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\t\t\tconst that = $(e.target).closest('.acf-table-add-row');\r\n\t\t\tconst p = {};\r\n\r\n\t\t\tp.obj_row = that.parent().parent();\r\n\r\n\t\t\tthis.table_add_row(p);\r\n\t\t\treturn false;\r\n\t\t});\r\n\t}\r\n\r\n\ttable_add_row(p) {\r\n\t\t// requires\r\n\t\t// p.obj_row\r\n\r\n\t\tlet that_index = 0;\r\n\t\tlet col_amount = 0;\r\n\t\tlet body_cells_html = '';\r\n\r\n\t\tp.obj_root = p.obj_row.parents('.acf-table-root');\r\n\t\tp.obj_table = p.obj_root.find('.acf-table-table');\r\n\t\tp.obj_table_rows = p.obj_table.children();\r\n\t\tcol_amount = p.obj_table.find('.acf-table-top-cell').size();\r\n\t\tthat_index = p.obj_row.index();\r\n\r\n\t\tfor (let i = 0; i < col_amount; i++) {\r\n\t\t\tlet cellContent = null;\r\n\t\t\tconst columnId = this.var.columIds[i];\r\n\t\t\tif (columnId) {\r\n\t\t\t\tcellContent = this.config.stepDefinitions[columnId] ? this.config.stepDefinitions[columnId].def : '';\r\n\t\t\t\tconst stepDef = this.config.stepDefinitions?.[columnId];\r\n\t\t\t\tif (stepDef && stepDef.type === 'link') {\r\n\t\t\t\t\tcellContent = '$keep-prev-step-url';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbody_cells_html += this.get_column_html(Number(i), cellContent, that_index);\r\n\t\t}\r\n\r\n\t\t$(p.obj_table_rows[that_index])\r\n\t\t\t.after(this.tableHtml.body_row)\r\n\t\t\t.next()\r\n\t\t\t.find('.acf-table-body-left')\r\n\t\t\t.after(body_cells_html);\r\n\r\n\t\tthis.table_left_labels(p);\r\n\r\n\t\tp.obj_table.find('.acf-table-remove-col').show();\r\n\t\tp.obj_table.find('.acf-table-remove-row').show();\r\n\r\n\t\tthis.table_build_json(p);\r\n\r\n\t\t$('.acf-table-sort-row-icon:not(.acf-table-sort-row-icon--loaded)').load(urlJoin(this.config.assetsUrl, '/icons/arrows-alt-v-solid.svg')).addClass('acf-table-sort-row-icon--loaded').fadeIn(700);\r\n\t}\r\n\r\n\ttable_add_link() {\r\n\t\tthis.jBody.on('click', '.acf-table-add-link', (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tconst jUl = $(e.target).closest('.acf-table-body-cont').find('ul');\r\n\t\t\tif (jUl.length) {\r\n\t\t\t\tjUl.append(this.tableHtml.body_cell_link_sub_item(''));\r\n\t\t\t\t$(jUl).children('li:last-child').trigger('click');\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\ttable_remove_link() {\r\n\t\tthis.jBody.on('click', '.acf-table-remove-link', (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\t\t\tconst p = {};\r\n\t\t\tconst that = $(e.target).closest('.acf-table-remove-link');\r\n\t\t\tp.obj_root = that.parents('.acf-table-root');\r\n\t\t\tp.obj_table = p.obj_root.find('.acf-table-table');\r\n\t\t\tp.obj_rows = p.obj_root.find('.acf-table-body-row');\r\n\t\t\t$(e.target).closest('li').remove();\r\n\t\t\tthis.table_build_json(p);\r\n\t\t\tadjustVisualBuilderButtons(true, this.config.siteUrl);\r\n\t\t});\r\n\t}\r\n\r\n\ttable_remove_row() {\r\n\t\tthis.jBody.on('click', '.acf-table-remove-row', (e) => {\r\n\t\t\te.preventDefault();\r\n\r\n\r\n\t\t\tconst that = $(e.target).closest('.acf-table-remove-row');\r\n\t\t\tlet rows_count = false;\r\n\r\n\t\t\tconst p = {};\r\n\t\t\tp.obj_root = that.parents('.acf-table-root');\r\n\t\t\tp.obj_table = p.obj_root.find('.acf-table-table');\r\n\t\t\tp.obj_rows = p.obj_root.find('.acf-table-body-row');\r\n\r\n\t\t\trows_count = p.obj_rows.length;\r\n\r\n\t\t\tthat.parent().parent().remove();\r\n\r\n\t\t\tif (rows_count == 1) {\r\n\t\t\t\tthis.table_add_row({\r\n\t\t\t\t\tobj_row: p.obj_table.find('.acf-table-header-row'),\r\n\t\t\t\t});\r\n\r\n\t\t\t\tp.obj_table.find('.acf-table-remove-row').hide();\r\n\t\t\t}\r\n\r\n\t\t\tthis.table_left_labels(p);\r\n\r\n\t\t\tthis.table_build_json(p);\r\n\t\t});\r\n\t}\r\n\r\n\ttable_top_labels(p) {\r\n\t\tlet letter_i_1 = 'A'.charCodeAt(0);\r\n\t\tlet letter_i_2 = 'A'.charCodeAt(0);\r\n\t\tlet use_2 = false;\r\n\r\n\t\tp.obj_table.find('.acf-table-top-cont').each((_, element) => {\r\n\t\t\tlet string = '';\r\n\r\n\t\t\tif (!use_2) {\r\n\t\t\t\tstring = String.fromCharCode(letter_i_1);\r\n\r\n\t\t\t\tif (letter_i_1 === 'Z'.charCodeAt(0)) {\r\n\t\t\t\t\tletter_i_1 = 'A'.charCodeAt(0);\r\n\t\t\t\t\tuse_2 = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tletter_i_1 += 1;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tstring = String.fromCharCode(letter_i_1) + String.fromCharCode(letter_i_2);\r\n\r\n\t\t\t\tif (letter_i_2 === 'Z'.charCodeAt(0)) {\r\n\t\t\t\t\tletter_i_1 += 1;\r\n\t\t\t\t\tletter_i_2 = 'A'.charCodeAt(0);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tletter_i_2 += 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t$(element).text(string);\r\n\t\t});\r\n\t}\r\n\r\n\ttable_left_labels(p) {\r\n\t\tlet i = 0;\r\n\r\n\t\tp.obj_table.find('.acf-table-body-left').each((_, element) => {\r\n\t\t\ti += 1;\r\n\r\n\t\t\t$(element).find('.acf-table-body-cont').text(i);\r\n\t\t});\r\n\t}\r\n\r\n\r\n\tgetTableBodyCellContValAtomic(type, jContItem, contItemSelector = '.acf-table-body-cont-sub') {\r\n\t\tswitch (type) {\r\n\t\t\tcase 'checkbox': return jContItem.find(contItemSelector)[0].checked ? '1' : '0';\r\n\t\t\tcase 'number': return $(jContItem.find(contItemSelector)[0]).val();\r\n\t\t\tcase 'select': return $(jContItem.find(contItemSelector)[0]).val();\r\n\t\t\tcase 'link': {\r\n\t\t\t\tif (jContItem.parent().hasClass('acf-table-body-cell--link-multi')) {\r\n\t\t\t\t\tlet resArr = [];\r\n\t\t\t\t\tconst jLi = $(jContItem[0]).find('.acf-table-body-cont-li');\r\n\t\t\t\t\tif (jLi.length) {\r\n\t\t\t\t\t\tjLi.each((_, element) => {\r\n\t\t\t\t\t\t\tresArr.push($(element).find('span').text());\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn resArr.filter(n => n).join(',');\r\n\t\t\t\t}\r\n\t\t\t\telse return jContItem.html();\r\n\t\t\t}\r\n\t\t\tcase 'ext_only': return '';\r\n\t\t\tdefault: {\r\n\t\t\t\tlet html = jContItem.clone()    //clone the element\r\n\t\t\t\t\t.children('.acf-table-cell-ec') //select all the children with extended data\r\n\t\t\t\t\t.remove()   //remove all the children\r\n\t\t\t\t\t.end()  //again go back to selected element\r\n\t\t\t\t\t.html();\r\n\t\t\t\treturn html;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tgetStepExtCfg(columnId) {\r\n\t\treturn columnId && this.config.stepDefinitions[columnId] ? this.config.stepDefinitions[columnId]?.ext : null;\r\n\t}\r\n\r\n\tgetTableBodyCellContVal(columnId, jContItem) {\r\n\t\tlet res = {};\r\n\t\tconst stepDef = this.config.stepDefinitions?.[columnId];\r\n\t\tconst extCfg = this.getStepExtCfg(columnId);\r\n\t\tif (stepDef) {\r\n\t\t\tlet mainVal = this.getTableBodyCellContValAtomic(stepDef.type, jContItem);\r\n\t\t\tif (extCfg) {\r\n\t\t\t\tconst extVal = {};\r\n\t\t\t\tjContItem.find('.acf-cell-eci-wrap').each((_, element) => {\r\n\t\t\t\t\tconst id = $(element).attr('data-id');\r\n\t\t\t\t\tif (id && extCfg[id]) {\r\n\t\t\t\t\t\tconst type = extCfg[id].type;\r\n\t\t\t\t\t\tif (type) {\r\n\t\t\t\t\t\t\textVal[id] = this.getTableBodyCellContValAtomic(type, $(element));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tmainVal = DPIncUtils.encodeStepParamAdvancedVal({ val: mainVal, ext: extVal }, columnId, this.config.stepDefinitions);\r\n\t\t\t}\r\n\t\t\tres = mainVal;\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\r\n\r\n\r\n\ttable_build_json(p) {\r\n\t\tlet i = 0;\r\n\t\tlet i2 = 0;\r\n\r\n\t\tp.data = this.data_get(p);\r\n\t\tthis.data_default(p);\r\n\r\n\t\tp.data.c = [];\r\n\t\tp.data.h = [];\r\n\t\tp.data.b = [];\r\n\r\n\t\t// TOP {\r\n\r\n\t\ti = 0;\r\n\r\n\t\tp.obj_table.find('.acf-table-top-cont').each((_, element) => {\r\n\t\t\tp.data.c[i] = {};\r\n\t\t\tp.data.c[i].p = $(element).parent().data('colparam');\r\n\r\n\t\t\ti += 1;\r\n\t\t});\r\n\r\n\t\t// }\r\n\r\n\t\t// HEADER {\r\n\r\n\t\ti = 0;\r\n\r\n\t\tp.obj_table.find('.acf-table-header-cont').each((_, element) => {\r\n\t\t\tp.data.h[i] = {};\r\n\t\t\tp.data.h[i].c = $(element).html();\r\n\t\t\tp.data.h[i].v = $(element).data('val');\r\n\r\n\t\t\ti += 1;\r\n\t\t});\r\n\r\n\t\t// }\r\n\r\n\t\t// BODY {\r\n\r\n\t\ti = 0;\r\n\t\ti2 = 0;\r\n\r\n\t\tp.obj_table.find('.acf-table-body-row').each((_, element_row) => {\r\n\t\t\tp.data.b[i] = [];\r\n\r\n\t\t\t$(element_row).find('.acf-table-body-cell .acf-table-body-cont').each((_, element) => {\r\n\t\t\t\tp.data.b[i][i2] = {};\r\n\t\t\t\tconst columnId = this.var.columIds[i2];\r\n\t\t\t\tif (columnId) {\r\n\t\t\t\t\tp.data.b[i][i2].c = this.getTableBodyCellContVal(columnId, $(element));\r\n\t\t\t\t}\r\n\t\t\t\ti2 += 1;\r\n\t\t\t});\r\n\r\n\t\t\ti2 = 0;\r\n\t\t\ti += 1;\r\n\t\t});\r\n\r\n\t\t// }\r\n\r\n\t\t// UPDATE INPUT WITH NEW DATA {\r\n\r\n\t\tthis.update_table_data_field(p);\r\n\r\n\t\t// }\r\n\t}\r\n\r\n\tupdate_table_data_field(p) {\r\n\t\t// UPDATE INPUT WITH NEW DATA {\r\n\r\n\t\tp.data = this.update_table_data_version(p.data);\r\n\r\n\t\t// makes json string from data object\r\n\t\tlet data = JSON.stringify(p.data);\r\n\r\n\t\t// adds backslash to all \\\" in JSON string because encodeURIComponent() strippes backslashes\r\n\t\tdata.replace(/\\\\\"/g, '\\\\\"');\r\n\r\n\t\t// encodes the JSON string to URI component, the format, the JSON string is saved to the database\r\n\t\tdata = encodeURIComponent(data);\r\n\r\n\t\tp.obj_root.find('input.table').val(data);\r\n\r\n\t\tthis.field_changed(p);\r\n\r\n\t\t// }\r\n\t}\r\n\r\n\tupdate_table_data_version(data) {\r\n\t\tif (typeof data.acftf === 'undefined') {\r\n\t\t\tdata.acftf = {};\r\n\t\t}\r\n\r\n\t\tdata.acftf.v = this.version;\r\n\r\n\t\treturn data;\r\n\t}\r\n\r\n\r\n\ttmce_cell_editor() {\r\n\t\tthis.tmce = new DpTinyMceDialog(this.config.tmce, (target, content) => {\r\n\t\t\tif (target) {\r\n\t\t\t\ttarget.html(content);\r\n\t\t\t\tconst p = {};\r\n\t\t\t\tp.obj_root = target.parents('.acf-table-root');\r\n\t\t\t\tp.obj_table = p.obj_root.find('.acf-table-table');\r\n\t\t\t\tp.obj_rows = p.obj_root.find('.acf-table-body-row');\r\n\t\t\t\tconst currentRow = target.closest('.acf-table-body-row');\r\n\t\t\t\tcurrentRow.find('.acf-cell-eci-wrap[data-id=\"build_with_wp_editor\"] input').prop('checked', true);\r\n\t\t\t\tcurrentRow.find('.acf-table-body-cell--text_wp_edit .acf-table-body-cont').addClass('acf-table-body-cont--rt');\r\n\r\n\t\t\t\tthis.table_build_json(p);\r\n\t\t\t}\r\n\t\t}, false, this.config.dpDebugEn);\r\n\t\tthis.jBody.on('click', '.acf-table-body-cell--text_wp_edit', (e) => {\r\n\r\n\t\t\tlet jTargetContentEl = ($(e.target).hasClass('acf-table-body-cont')) ? $(e.target) : $(e.target).find('.acf-table-body-cont');\r\n\t\t\tif (!jTargetContentEl.length) jTargetContentEl = $(e.target).closest('.acf-table-body-cont');\r\n\t\t\t//console.log($(e.target), jTargetContentEl, jTargetContentEl.html());\r\n\t\t\tthis.tmce.open(jTargetContentEl, jTargetContentEl.html(), this.getStepIdx($(e.target)));\r\n\t\t});\r\n\t}\r\n\r\n\teditor_custom_style() {\r\n\r\n\t\tDPIncUtils.setTextStyles(this.jBody[0], this.config?.text_styles);\r\n\t\t/*if (!$.isEmptyObject(this.config?.text_styles)) {\r\n\t\t\tthis.jBody.addClass();\r\n\t\t}*/\r\n\r\n\t}\r\n\r\n\r\n\tlink_editor() {\r\n\t\tthis.jBody.on('click', '.acf-table-body-cell--link', (e) => {\r\n\t\t\tif (this.dpWpLink) {\r\n\t\t\t\tconst that = $(e.target).closest('.acf-table-body-cell--link');\r\n\t\t\t\tthis.state.current_cell_obj = that;\r\n\t\t\t\tlet openDpWpLink = true;\r\n\t\t\t\tlet text = '';\r\n\t\t\t\tlet jSubEl = null;\r\n\t\t\t\tconst content = that.find('.acf-table-body-cont');\r\n\t\t\t\tif (content.length) {\r\n\t\t\t\t\tconst jLi = $(e.target).closest('.acf-table-body-cont-li');\r\n\t\t\t\t\tif (jLi.length) {\r\n\t\t\t\t\t\tjSubEl = $(jLi[0]).find('span');\r\n\t\t\t\t\t\tif (jSubEl.length) text = $(jSubEl[0]).text();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (!content.find('ul').length) {\r\n\t\t\t\t\t\ttext = $(content[0]).text();\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\topenDpWpLink = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (openDpWpLink) {\r\n\t\t\t\t\tconst stepIdx = this.getStepIdx(that);// that.closest('.acf-table-body-row').find('.acf-table-body-left .acf-table-body-cont').text();\r\n\r\n\t\t\t\t\tconst urlVarExamplesStr = $('.acf-field[data-name=\"url_vars_examples\"] textarea').val();\r\n\t\t\t\t\tlet urlVarExamples = null;\r\n\t\t\t\t\tif (urlVarExamplesStr) {\r\n\t\t\t\t\t\turlVarExamples = DPIncUtils.strToSimpleObject(urlVarExamplesStr, '\\n');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.dpWpLink.open(text, null, false, true, stepIdx, isUrlVariableProcessingEnabled(), urlVarExamples, this.config.sysUrlVars, jSubEl);\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tsimple_cell_editor() {\r\n\t\tthis.jBody.on('click', '.acf-table-body-cell--text', (e) => {\r\n\t\t\tconst that = $(e.target).closest('.acf-table-body-cell--text');\r\n\t\t\te.stopImmediatePropagation();\r\n\t\t\tif (!$(e.target).closest('.acf-table-cell-ec').length) {\r\n\t\t\t\tthis.cell_editor_save();\r\n\t\t\t\tthis.cell_editor_add_editor({ that });\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.jBody.on('click', '.acf-table-cell-editor-textarea', (e) => {\r\n\t\t\te.stopImmediatePropagation();\r\n\t\t});\r\n\r\n\t\tthis.jBody.on('click', () => {\r\n\t\t\tthis.cell_editor_save();\r\n\t\t});\r\n\t}\r\n\r\n\tgetStepIdx(jTarget) {\r\n\t\treturn Number(jTarget.closest('.acf-table-body-row').find('.acf-table-body-left .acf-table-body-cont').text());\r\n\t}\r\n\r\n\tcell_editor_add_editor(p) {\r\n\t\tconst defaults = {\r\n\t\t\tthat: false,\r\n\t\t};\r\n\r\n\t\tp = $.extend(true, defaults, p);\r\n\r\n\t\tif (p.that) {\r\n\t\t\tthis.state.current_cell_obj = p.that;\r\n\r\n\t\t\tif (p.that.hasClass('acf-table-body-cell--text')) {\r\n\t\t\t\tconst that_val = p.that.find('.acf-table-body-cont, .acf-table-header-cont').html();\r\n\t\t\t\tthis.state.cell_editor_is_open = true;\r\n\r\n\t\t\t\tp.that.prepend(this.tableHtml.htmleditor).find('.acf-table-cell-editor-textarea').html(that_val).focus();\r\n\t\t\t\t$('.acf-table-cell-editor').fadeIn();\r\n\t\t\t\tp.that.find('.acf-table-body-cont').addClass('hidden-for-edit');\r\n\t\t\t\tconst textAreaElement = $('.acf-table-cell-editor-textarea')[0];\r\n\t\t\t\tautosize(textAreaElement);\r\n\t\t\t\ttextAreaElement.focus();\r\n\t\t\t\ttextAreaElement.setSelectionRange(textAreaElement.value.length, textAreaElement.value.length);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tget_next_table_cell() {\r\n\t\t// next cell of current row\r\n\t\tlet next_cell = this.state.current_cell_obj\r\n\t\t\t.next('.acf-table-body-cell, .acf-table-header-cell');\r\n\r\n\t\t// else if get next row\r\n\t\tif (next_cell.length === 0) {\r\n\t\t\tnext_cell = this.state.current_cell_obj\r\n\t\t\t\t.parent()\r\n\t\t\t\t.next('.acf-table-body-row')\r\n\t\t\t\t.find('.acf-table-body-cell')\r\n\t\t\t\t.first();\r\n\t\t}\r\n\r\n\t\t// if next row, get first cell of that row\r\n\t\tif (next_cell.length !== 0) {\r\n\t\t\tthis.state.current_cell_obj = next_cell;\r\n\t\t} else {\r\n\t\t\tthis.state.current_cell_obj = false;\r\n\t\t}\r\n\t}\r\n\r\n\tget_prev_table_cell() {\r\n\r\n\t\t// prev cell of current row\r\n\t\tconst table_obj = this.state.current_cell_obj.closest('.acf-table-table');\r\n\t\tconst no_header = table_obj.hasClass('acf-table-hide-header');\r\n\t\tlet prev_cell = this.state.current_cell_obj\r\n\t\t\t.prev('.acf-table-body-cell, .acf-table-header-cell');\r\n\r\n\t\t// else if get prev row\r\n\t\tif (prev_cell.length === 0) {\r\n\t\t\tconst row_selectors = ['.acf-table-body-row'];\r\n\r\n\t\t\t// prevents going to header cell if table header is hidden\r\n\t\t\tif (no_header === false) {\r\n\t\t\t\trow_selectors.push('.acf-table-header-row');\r\n\t\t\t}\r\n\r\n\t\t\tprev_cell = this.state.current_cell_obj\r\n\t\t\t\t.parent()\r\n\t\t\t\t.prev(row_selectors.join(','))\r\n\t\t\t\t.find('.acf-table-body-cell, .acf-table-header-cell')\r\n\t\t\t\t.last();\r\n\t\t}\r\n\r\n\t\t// if next row, get first cell of that row\r\n\t\tif (prev_cell.length !== 0) {\r\n\t\t\tthis.state.current_cell_obj = prev_cell;\r\n\t\t} else {\r\n\t\t\tthis.state.current_cell_obj = false;\r\n\t\t}\r\n\t}\r\n\r\n\trebuild_table_data(trigger) {\r\n\t\tconst root = $(trigger).parents('.acf-table-root');\r\n\t\tconst p = {\r\n\r\n\t\t\tobj_root: root,\r\n\t\t\tobj_table: root.find('.acf-table-table'),\r\n\t\t};\r\n\t\tthis.table_build_json(p);\r\n\t}\r\n\r\n\tcell_editor_save() {\r\n\t\tconst cell_editor = this.jBody.find('.acf-table-cell-editor');\r\n\t\tconst cell_editor_textarea = cell_editor.find('.acf-table-cell-editor-textarea');\r\n\t\tconst p = {};\r\n\t\tvar cell_editor_val = '';\r\n\t\t$(cell_editor.next()).removeClass('hidden-for-edit');\r\n\t\tif (typeof cell_editor_textarea.val() !== 'undefined') {\r\n\t\t\tp.obj_root = cell_editor.parents('.acf-table-root');\r\n\t\t\tp.obj_table = p.obj_root.find('.acf-table-table');\r\n\r\n\t\t\tcell_editor_val = cell_editor_textarea.val();\r\n\r\n\t\t\t// prevent XSS injection\r\n\t\t\tcell_editor_val = cell_editor_val.replace(/<(script)/ig, '&#060;$1');\r\n\t\t\tcell_editor_val = cell_editor_val.replace(/<\\/(script)/ig, '&#060;/$1');\r\n\r\n\t\t\tcell_editor.next().html(cell_editor_val);\r\n\r\n\t\t\tthis.table_build_json(p);\r\n\r\n\t\t\tcell_editor.remove();\r\n\t\t\tthis.state.cell_editor_is_open = false;\r\n\r\n\t\t\tp.obj_root.find('.acf-table-remove-col').show(), p.obj_root.find('.acf-table-remove-row').show();\r\n\t\t}\r\n\r\n\t\t$('.acf-table-cell-editor').fadeOut();\r\n\t}\r\n\r\n\tcell_editor_tab_navigation() {\r\n\t\tthis.jBody.on('keydown', '.acf-table-cell-editor', (e) => {\r\n\t\t\tconst keyCode = e.keyCode || e.which;\r\n\r\n\t\t\tif (keyCode == 9) {\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\tthis.cell_editor_save();\r\n\r\n\t\t\t\tif (this.state.cell_editor_last_keycode === 16) {\r\n\t\t\t\t\tthis.get_prev_table_cell();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.get_next_table_cell();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.cell_editor_add_editor({\r\n\t\t\t\t\tthat: this.state.current_cell_obj,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tthis.state.cell_editor_last_keycode = keyCode;\r\n\t\t});\r\n\t}\r\n\r\n\tprevent_cell_links() {\r\n\t\tthis.jBody.on('click', '.acf-table-body-cont a, .acf-table-header-cont a', (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t});\r\n\t}\r\n\r\n\tsortable_fix_width(e, ui) {\r\n\t\tui.children().each((_, element) => {\r\n\t\t\tconst that = $(element);\r\n\r\n\t\t\tthat.width(that.width());\r\n\t\t});\r\n\r\n\t\treturn ui;\r\n\t}\r\n\r\n\tsortable_row() {\r\n\t\tconst that = this;\r\n\t\tconst param = {\r\n\t\t\taxis: 'y',\r\n\t\t\titems: '> .acf-table-body-row',\r\n\t\t\tcontainment: 'parent',\r\n\t\t\thandle: '.acf-table-body-left', // .acf-table-body-cont',\r\n\t\t\thelper: this.sortable_fix_width,\r\n\t\t\tcancel: '.no-drag',\r\n\t\t\tupdate(event, ui) {\r\n\t\t\t\t// console.log(event);\r\n\t\t\t\tconst p = {};\r\n\r\n\t\t\t\tp.obj_root = ui.item.parents('.acf-table-root');\r\n\t\t\t\tp.obj_table = p.obj_root.find('.acf-table-table');\r\n\r\n\t\t\t\tthat.table_left_labels(p);\r\n\t\t\t\tthat.table_build_json(p);\r\n\t\t\t},\r\n\t\t};\r\n\t\t$('.acf-table-table').sortable(param);\r\n\t}\r\n\r\n\tsortable_col() {\r\n\t\tconst p = {};\r\n\r\n\t\tp.start_index = 0;\r\n\t\tp.end_index = 0;\r\n\r\n\t\tconst param = {\r\n\t\t\taxis: 'x',\r\n\t\t\titems: '> .acf-table-top-cell',\r\n\t\t\tcontainment: 'parent',\r\n\t\t\thelper: this.sortable_fix_width,\r\n\t\t\tstart(event, ui) {\r\n\t\t\t\tp.start_index = ui.item.index();\r\n\t\t\t},\r\n\t\t\tupdate(event, ui) {\r\n\t\t\t\tp.end_index = ui.item.index();\r\n\r\n\t\t\t\tp.obj_root = ui.item.parents('.acf-table-root');\r\n\t\t\t\tp.obj_table = p.obj_root.find('.acf-table-table');\r\n\r\n\t\t\t\tthis.table_top_labels(p);\r\n\t\t\t\tthis.sort_cols(p);\r\n\t\t\t\tthis.table_build_json(p);\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\t$('.acf-table-top-row').sortable(param);\r\n\r\n\t\tthis.jBody.on('click', '.acf-fc-popup', () => {\r\n\t\t\t$('.acf-table-top-row')\r\n\t\t\t\t.sortable('destroy')\r\n\t\t\t\t.unbind();\r\n\r\n\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t$('.acf-table-top-row').sortable(param);\r\n\t\t\t}, 300);\r\n\t\t});\r\n\t}\r\n\r\n\tfield_changed(p) {\r\n\t\tif (p.field_context === 'block') {\r\n\t\t\tp.obj_root.change();\r\n\t\t}\r\n\t}\r\n\r\n\tsort_cols(p) {\r\n\t\tp.obj_table.find('.acf-table-header-row').each((_, element) => {\r\n\t\t\tp.header_row = $(element);\r\n\t\t\tp.header_row_children = p.header_row.children();\r\n\r\n\t\t\tif (p.end_index < p.start_index) {\r\n\t\t\t\t$(p.header_row_children[p.end_index]).before($(p.header_row_children[p.start_index]));\r\n\t\t\t}\r\n\r\n\t\t\tif (p.end_index > p.start_index) {\r\n\t\t\t\t$(p.header_row_children[p.end_index]).after($(p.header_row_children[p.start_index]));\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tp.obj_table.find('.acf-table-body-row').each((_, element) => {\r\n\t\t\tp.body_row = $(element), p.body_row_children = p.body_row.children();\r\n\r\n\t\t\tif (p.end_index < p.start_index) {\r\n\t\t\t\t$(p.body_row_children[p.end_index]).before($(p.body_row_children[p.start_index]));\r\n\t\t\t}\r\n\r\n\t\t\tif (p.end_index > p.start_index) {\r\n\t\t\t\t$(p.body_row_children[p.end_index]).after($(p.body_row_children[p.start_index]));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}","import DPTourEditCTAs from './modules/DPTourEditCTAs';\r\nimport DPProPromoButton from './modules/DPProPromoButton';\r\nimport DPAcfAdjust from './modules/DPAcfAdjust';\r\nimport AcfTippy from './modules/AcfTippy';\r\nimport AcfTableField from './modules/AcfTableField';\r\n\r\njQuery(document).ready(($) => {\r\n\twindow.$ = $;\r\n\tif (window.dpIntroToursAdminTourEditConfig.dpDebugEn) console.log('Admin Tour Edit Config:', window.dpIntroToursAdminTourEditConfig);\r\n\tnew DPAcfAdjust(window.dpIntroToursAdminTourEditConfig);\r\n\tnew DPProPromoButton(window.dpIntroToursAdminTourEditConfig);\r\n\r\n\r\n});\r\n\r\n// Initialize after acf is loaded.\r\nif (window.acf) {\r\n\twindow.acf.addAction('load', () => {\r\n\t\twindow.$ = jQuery;\r\n\t\tconst acfTable = new AcfTableField({\r\n\t\t\t...window.dpIntroToursAdminTourEditConfig.acfTable,\r\n\t\t\tstepDefinitions: window.dpIntroToursAdminTourEditConfig.stepDefinitions\r\n\t\t});\r\n\t\tnew AcfTippy(window.dpIntroToursAdminTourEditConfig, () => {\r\n\t\t\tacfTable.ui_init_drag_to_scroll();\r\n\t\t\tnew DPTourEditCTAs(window.dpIntroToursAdminTourEditConfig);\r\n\t\t});\r\n\t});\r\n}\r\n","export default class BulletsAnimation {\r\n\tconstructor(containerSelector, id, bulletsClasses, count = 10, clockPeriodMs = 100) {\r\n\t\tthis.containerSelector = containerSelector;\r\n\t\tthis.bulletsClasses = bulletsClasses;\r\n\t\tthis.id = id;\r\n\t\tthis.count = count;\r\n\t\tthis.clockPeriodMs = clockPeriodMs;\r\n\t}\r\n\r\n\tcreateAndRun(backward = false, containerLayerOverride = null) {\r\n\t\tthis.backward = backward;\r\n\t\tconst jOverlayLayer = $(containerLayerOverride || this.containerSelector);\r\n\t\tif (jOverlayLayer && jOverlayLayer.length) {\r\n\t\t\tconst jBullets = jOverlayLayer.find(`#${this.id}`);\r\n\t\t\tif (!jBullets || !jBullets.length) {\r\n\t\t\t\tconst bullet4Animation = this.createBullets(this.count);\r\n\t\t\t\tjOverlayLayer[0].appendChild(bullet4Animation);\r\n\t\t\t} else {\r\n\t\t\t\tjBullets.removeClass('inactive');\r\n\t\t\t}\r\n\t\t\tif (backward) this.startReloadingSpinnerBack();\r\n\t\t\telse this.startReloadingSpinner();\r\n\t\t}\r\n\t}\r\n\r\n\tcreateBullets(count) {\r\n\t\t// this.bulletCount = count;\r\n\t\tconst bulletsLayer = document.createElement('div');\r\n\t\t$(bulletsLayer).addClass(this.bulletsClasses.join(' '));\r\n\t\t$(bulletsLayer).attr('aria-hidden', 'true');\r\n\t\tbulletsLayer.id = this.id;\r\n\t\tbulletsLayer.style.opacity = 0;\r\n\t\tbulletsLayer.style.display = 'block';\r\n\r\n\t\tconst ulContainer = document.createElement('ul');\r\n\t\tfor (let i = 0; i < count; i++) {\r\n\t\t\tconst innerLi = document.createElement('li');\r\n\t\t\tulContainer.appendChild(innerLi);\r\n\t\t}\r\n\t\tbulletsLayer.appendChild(ulContainer);\r\n\t\tbulletsLayer.style.opacity = 1;\r\n\t\treturn bulletsLayer;\r\n\t}\r\n\r\n\tactivateBullet(idx) {\r\n\t\t$(`#${this.id} li`).removeClass('active');\r\n\t\t$(`#${this.id} li`).removeClass('semi-active');\r\n\t\t$(`#${this.id} li`).removeClass('semi-active--2');\r\n\t\tif (this.backward) {\r\n\t\t\tif (idx >= 0 && idx < this.count) $(`#${this.id} li:nth-child(${idx + 1})`).addClass('semi-active semi-active--2');\r\n\t\t\tif ((idx - 1) >= 0 && (idx - 1) < this.count) $(`#${this.id} li:nth-child(${idx})`).addClass('semi-active');\r\n\t\t\tif ((idx - 2) >= 0 && (idx - 2) < this.count) $(`#${this.id} li:nth-child(${idx - 1})`).addClass('active');\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (idx >= 0 && idx < this.count) $(`#${this.id} li:nth-child(${idx + 1})`).addClass('active');\r\n\t\t\tif ((idx - 1) >= 0 && (idx - 1) < this.count) $(`#${this.id} li:nth-child(${idx})`).addClass('semi-active');\r\n\t\t\tif ((idx - 2) >= 0 && (idx - 2) < this.count) $(`#${this.id} li:nth-child(${idx - 1})`).addClass('semi-active semi-active--2');\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\t$(`#${this.id}`).addClass('inactive');\r\n\t\t$(`#${this.id} li`).removeClass('active');\r\n\t\t$(`#${this.id} li`).removeClass('semi-active');\r\n\t\tthis.stopReloadSpinner();\r\n\t}\r\n\r\n\tstopReloadSpinner() {\r\n\t\tif (this.spinnerInterval) clearInterval(this.spinnerInterval);\r\n\t\tthis.spinnerInterval = null;\r\n\t}\r\n\r\n\tstartReloadingSpinner() {\r\n\t\tlet idx = 0;\r\n\t\tif (this.spinnerInterval) clearInterval(this.spinnerInterval);\r\n\t\tif (this.bulletHideTimeout) clearTimeout(this.bulletHideTimeout);\r\n\t\tthis.spinnerInterval = setInterval(() => {\r\n\t\t\tthis.activateBullet(idx);\r\n\t\t\tidx++;\r\n\t\t\tif (idx > Math.round(2.2 * this.count)) idx = 0;\r\n\t\t}, this.clockPeriodMs);\r\n\t}\r\n\r\n\tstartReloadingSpinnerBack() {\r\n\t\tif (this.spinnerInterval) clearInterval(this.spinnerInterval);\r\n\t\tif (this.bulletHideTimeout) clearTimeout(this.bulletHideTimeout);\r\n\t\tlet idx = this.count + 2;\r\n\t\tthis.spinnerInterval = setInterval(() => {\r\n\t\t\tthis.activateBullet(idx);\r\n\t\t\tidx--;\r\n\t\t\tif (idx < 0) idx = Math.round(2.2 * this.count);\r\n\t\t}, this.clockPeriodMs);\r\n\t}\r\n}\r\n","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","import classNames from 'classnames';\r\nimport DPIncUtils from '../../../../includes/assets/js/modules/DPIncUtils';\r\n\r\nexport const scrollToElementByUrlAndAnimate = (queryParamsDefs, urlParamIdOfElementId = 'dp_qpb_origin_el_id', urlParamIdOfCanceled = 'dp_qpb_canceled', addHighlightClass = false) => {\r\n\r\n\tconst currentUrl = new URL(window.location);\r\n\tconst originHashIdVal = DPIncUtils.getDpUrlParam(urlParamIdOfElementId, queryParamsDefs, currentUrl);\r\n\tconst canceled = DPIncUtils.getDpUrlParam(urlParamIdOfCanceled, queryParamsDefs, currentUrl);\r\n\tif (originHashIdVal) {\r\n\t\tscrollToElementAndAnimate($(`#${originHashIdVal}`), canceled, addHighlightClass);\r\n\t}\r\n};\r\n\r\nexport const scrollToElementAndAnimate = (jEl, canceled = false, addHighlihtClass = false) => {\r\n\tif (jEl && jEl.length) {\r\n\t\tconst adminBarHeight = $('#wpadminbar').outerHeight() || 0;\r\n\t\t$([document.documentElement, document.body]).animate({\r\n\t\t\tscrollTop: jEl.offset().top - (window.innerHeight - adminBarHeight) / 4,\r\n\t\t}, 700);\r\n\r\n\t\t// check if el is not in parent's scrolled container\r\n\t\tconst scrollParent = _getScrollParent(jEl[0]);\r\n\t\tif (scrollParent !== document.body) {\r\n\t\t\t// target is within a scrollable element\r\n\t\t\t_scrollParentToElement(scrollParent, jEl[0]);\r\n\t\t}\r\n\r\n\t\tif (!canceled) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tjEl.addClass('dp-visual-edited-acf');\r\n\r\n\t\t\t\tif (/* this.config.isPRO && */addHighlihtClass) {\r\n\t\t\t\t\tjEl.addClass('dp-highlighted-el');\r\n\t\t\t\t\tjEl.on('click', () => {\r\n\t\t\t\t\t\tjEl.removeClass('dp-highlighted-el');\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tjEl.removeClass('dp-visual-edited-acf');\r\n\t\t\t\t}, 1100);\r\n\t\t\t}, 750);\r\n\t\t}\r\n\t}\r\n};\r\n\r\n\r\n\r\n\r\nexport const getRedirectUrlQueryString = (queryParamsDefs, tourId, builderMode = 1, hashId = '', origin = 'admin', triggerIdx = null) => {\r\n\t// dp_to_check\r\n\tconst params = {\r\n\t\tdp_qpb_builder_mode: builderMode,\r\n\t\tdp_qpb_builder_origin: origin,\r\n\t\tdp_qpb_origin_el_id: hashId,\r\n\t\tdp_qp_tour_id: tourId,\r\n\t\tdp_qp_run_always_on_load: '1',\r\n\t\tdp_qp_trigger_id: triggerIdx\r\n\t};\r\n\treturn DPIncUtils.buildDpQueryString(params, queryParamsDefs, '?');\r\n};\r\n\r\nexport const isVisualBuilderReadyPRO = (firstStepUrl, globalStartAtAllPages, outData = {}) => {\r\n\toutData.isVariableUrl = false;\r\n\toutData.origUrl = firstStepUrl;\r\n\toutData.globalStartAtAllPages = globalStartAtAllPages;\r\n\tlet allVarExamplesAreSet = false;\r\n\toutData.enableUrlVariables = isUrlVariableProcessingEnabled();\r\n\tif (outData.enableUrlVariables) {\r\n\t\toutData.isVariableUrl = DPIncUtils.isVariableUrl(firstStepUrl);\r\n\r\n\t\tif (outData.isVariableUrl) {\r\n\t\t\toutData.urlVarExamples = DPIncUtils.strToSimpleObject($('.acf-field[data-name=\"url_vars_examples\"] textarea').val(), '\\n');\r\n\t\t\tif (outData.urlVarExamples && Object.keys(outData.urlVarExamples).length > 0) {\r\n\t\t\t\tallVarExamplesAreSet = Object.values(outData.urlVarExamples).every((val) => val.length > 0);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn (firstStepUrl && firstStepUrl.length && (!outData.isVariableUrl || allVarExamplesAreSet)) || globalStartAtAllPages;\r\n};\r\n\r\nexport const isGlobalStartAtAllPagesSet = () => {\r\n\treturn $('.acf-field[data-name=\"global_start_at_all_pages\"] .acf-switch').hasClass('-on');\r\n};\r\n\r\n\r\nexport const exploreStartUrl = (isPRO, outData = {}) => {\r\n\tif (!isPRO) {\r\n\t\tconst relatedPosts = $('.acf-field[data-name=\"intro_trigger\"] .acf-field[data-name=\"intro_related_posts\"] ul.select2-selection__rendered li:not(.select2-search--inline)');\r\n\t\treturn relatedPosts.length > 0;\r\n\t}\r\n\telse {\r\n\t\tconst jFirstStepUrlCell = $('.acf-field-table[data-name=\"intro_steps\"] .acf-table-body-row').first().find('.acf-table-body-cell--link');\r\n\t\tconst jFirstStepUrlCellContent = jFirstStepUrlCell.find('.acf-table-body-cont li:first-child span');\r\n\t\tconst url = jFirstStepUrlCellContent.text();\r\n\t\tconst _isGlobalStartAtAllPagesSet = isGlobalStartAtAllPagesSet();\r\n\r\n\t\tif (_isGlobalStartAtAllPagesSet) jFirstStepUrlCell.addClass('acf-table-body-cell--link-all-pages');\r\n\t\telse jFirstStepUrlCell.removeClass('acf-table-body-cell--link-all-pages');\r\n\r\n\t\treturn isVisualBuilderReadyPRO(url, _isGlobalStartAtAllPagesSet, outData);\r\n\t}\r\n};\r\n\r\nexport const isUrlVariableProcessingEnabled = () => $('.acf-field[data-name=\"url_vars_enabled\"] .acf-switch').hasClass('-on');\r\n\r\nexport const adjustVisualBuilderButtonsRaw = (jButton, isReady, testOutData, siteUrl, fadeTimeMs = 300) => {\r\n\tconst jAdminBarViewLinkEl = $('#wp-admin-bar-view a, .updated.notice > p > a');\r\n\tconst jAdminBarViewEl = $('#wp-admin-bar-view, .updated.notice');\r\n\tconst jPermalinkEl = $('#sample-permalink');\r\n\tconst jSlugBox = $('#edit-slug-box');\r\n\t$('#post-preview').fadeOut(fadeTimeMs);\r\n\tif (isReady) {\r\n\t\tjButton.removeClass('inactive');\r\n\t\tjAdminBarViewEl.fadeIn(fadeTimeMs);\r\n\t\tjSlugBox.fadeIn(fadeTimeMs);\r\n\t\tlet resUrl = '';\r\n\t\tif (testOutData.enableUrlVariables) {\r\n\t\t\tresUrl = DPIncUtils.fillUrlVariables(testOutData.urlVarExamples, testOutData.origUrl);\r\n\t\t} else if (testOutData.origUrl) {\r\n\t\t\tresUrl = testOutData.origUrl;\r\n\t\t}\r\n\t\tif (resUrl) {\r\n\t\t\tresUrl = DPIncUtils.sanitizePossibleRelativeUrl(resUrl, siteUrl);\r\n\t\t\tconst slugText = testOutData.globalStartAtAllPages ? '$ALL' : DPIncUtils.sanitizePossibleRelativeUrl(testOutData.origUrl, siteUrl);\r\n\t\t\tjPermalinkEl.attr('href', resUrl).text(slugText);\r\n\t\t\tjAdminBarViewLinkEl.attr('href', resUrl);\r\n\t\t}\r\n\t} else {\r\n\t\tjSlugBox.fadeOut(fadeTimeMs);\r\n\t\tjAdminBarViewEl.fadeOut(fadeTimeMs);\r\n\t\tjButton.addClass(classNames({ inactive: true, 'inactive--var-url': testOutData.isVariableUrl }));\r\n\t}\r\n\r\n\tif (!testOutData.enableUrlVariables) {\r\n\t\t$('.acf-field[data-name=\"url_vars_examples\"] textarea').addClass('url-vars-disabled');\r\n\t} else $('.acf-field[data-name=\"url_vars_examples\"] textarea').removeClass('url-vars-disabled');\r\n};\r\n\r\nexport const adjustVisualBuilderButtons = (isPRO, siteUrl, fadeTimeMs = 300) => {\r\n\tlet outData = {};\r\n\tconst isReady = exploreStartUrl(isPRO, outData);\r\n\tadjustVisualBuilderButtonsRaw($('.dpit-admin-btn-for-reload'), isReady, outData, siteUrl, fadeTimeMs);\r\n\treturn isReady;\r\n};\r\n\r\n\r\nconst _getScrollParent = (element) => {\r\n\tlet style = window.getComputedStyle(element);\r\n\tconst excludeStaticParent = (style.position === 'absolute');\r\n\tconst overflowRegex = /(auto|scroll)/;\r\n\r\n\tif (style.position === 'fixed') return document.body;\r\n\r\n\tfor (let parent = element; (parent = parent.parentElement);) {\r\n\t\tstyle = window.getComputedStyle(parent);\r\n\t\tif (excludeStaticParent && style.position === 'static') {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (overflowRegex.test(style.overflow + style.overflowY + style.overflowX)) return parent;\r\n\t}\r\n\r\n\r\n\r\n\treturn document.body;\r\n};\r\n\r\nconst _scrollParentToElement = (parent, element) => {\r\n\tparent.scrollTop = element.offsetTop;\r\n\tparent.scrollLeft = element.offsetLeft;\r\n};\r\n","import DPIncUtils from './DPIncUtils';\r\n\r\nexport default class DpTinyMceDialog {\r\n\tconstructor(config, onTmceSaved, onTmceCancel, dpDebugEn) {\r\n\t\tthis.config = config;\r\n\t\tthis.onTmceCancel = onTmceCancel;\r\n\t\tif (dpDebugEn) console.log('DpTinyMceDialog');\r\n\t\t$('#dp-step-content-edit .dp-tmce-dialog__btn').on('click', () => {\r\n\t\t\tif (onTmceSaved) {\r\n\t\t\t\t$('#dp-tmce-editor-tmce').trigger('click');\r\n\t\t\t\tonTmceSaved(this.target, window.tinyMCE.activeEditor.getContent());\r\n\t\t\t}\r\n\t\t\tthis.close(false);\r\n\t\t});\r\n\r\n\t\t$('#dp-step-content-edit .dp-tmce-dialog__close,#dp-step-content-edit__backdrop').on('click', () => {\r\n\t\t\tthis.close();\r\n\t\t});\r\n\t\t$(window).on('keydown', this.keydown.bind(this));\r\n\r\n\r\n\r\n\t\t//wp.editor.initialize('dp-tmce-editor', { tinymce: true });\r\n\t}\r\n\r\n\tkeydown(event) {\r\n\r\n\t\t// Escape key.\r\n\t\tif (this.modalOpened && event.keyCode === 27) {\r\n\t\t\tthis.close();\r\n\t\t}\r\n\t}\r\n\r\n\topen(target, data, stepIdx) {\r\n\t\tthis.modalOpened = true;\r\n\t\tif (stepIdx !== false && !isNaN(stepIdx)) {\r\n\t\t\tconst step = DPIncUtils.getNthStr(stepIdx);\r\n\t\t\t$('#dp-step-content-edit .dp-tmce-dialog__title').text(this.config.title.replace('%s', step));\r\n\t\t}\r\n\t\t$('#dp-step-content-edit').show();\r\n\t\t$('#dp-step-content-edit__backdrop').show();\r\n\t\tthis.hadDpitRelPos = $('body').hasClass('dpit-relative-position');\r\n\t\tif (this.hadDpitRelPos) {\r\n\t\t\t$('body').removeClass('dpit-relative-position');\r\n\t\t}\r\n\t\t$('body').addClass('dp-noscroll');\r\n\r\n\t\tthis.target = target;\r\n\t\t$('#dp-tmce-editor-tmce').trigger('click');\r\n\t\tthis.editor = window.tinyMCE.get('dp-tmce-editor');\r\n\t\tthis.editor.setContent(data ?? '', { format: 'html' });\r\n\t\tif (this.editor.selection) {\r\n\t\t\tthis.editor.selection.select(this.editor.getBody(), true);\r\n\t\t\tthis.editor.selection.collapse(false);\r\n\t\t}\r\n\t\tthis.editor.focus();\r\n\t}\r\n\r\n\r\n\tclose(wasCanceled = true) {\r\n\t\tthis.target = null;\r\n\t\tthis.modalOpened = false;\r\n\t\t$('#dp-step-content-edit').hide();\r\n\t\t$('#dp-step-content-edit__backdrop').hide();\r\n\t\t$('body').removeClass('dp-noscroll');\r\n\t\tif (wasCanceled && this.onTmceCancel) this.onTmceCancel();\r\n\t\tif (this.hadDpitRelPos) {\r\n\t\t\t$('body').addClass('dpit-relative-position');\r\n\t\t}\r\n\t}\r\n\r\n}","\r\nexport default class DpWpLinkQuery {\r\n\tconstructor(search, config) {\r\n\t\tif (config.dpDebugEn) console.log('DpWpLinkQuery');\r\n\t\tthis.config = config;\r\n\t\tthis.page = 1;\r\n\t\tthis.allLoaded = false;\r\n\t\tthis.querying = false;\r\n\t\tthis.search = search;\r\n\t\tthis.init();\r\n\t}\r\n\r\n\tinit() {\r\n\t\t$.extend(DpWpLinkQuery.prototype, {\r\n\t\t\tready() {\r\n\t\t\t\treturn !(this.querying || this.allLoaded);\r\n\t\t\t},\r\n\t\t\tajax(callback) {\r\n\t\t\t\tconst self = this;\r\n\t\t\t\tconst query = {\r\n\t\t\t\t\taction: 'dp-wp-link-ajax',\r\n\t\t\t\t\tpage: this.page,\r\n\t\t\t\t\t_dp_wplink_nonce: this.config._dp_wplink_nonce,\r\n\t\t\t\t};\r\n\t\t\t\tif (this.search) query.search = this.search;\r\n\r\n\t\t\t\tthis.querying = true;\r\n\r\n\t\t\t\t$.post(this.config.ajaxUrl, query, (r) => {\r\n\t\t\t\t\tself.page++;\r\n\t\t\t\t\tself.querying = false;\r\n\t\t\t\t\tself.allLoaded = !r;\r\n\t\t\t\t\tcallback(r, query);\r\n\t\t\t\t}, 'json');\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n}","\r\nimport DpWpLinkQuery from './DpWpLinkQuery';\r\n\r\n\r\nexport default class DpWpLinkRiver {\r\n\ttimeToTriggerRiver = 150;\r\n\tminRiverAJAXDuration = 200;\r\n\triverBottomThreshold = 5;\r\n\tposts = {};\r\n\r\n\tconstructor(element, dpWpLink) {\r\n\t\tif (dpWpLink.config.dpDebugEn) console.log('DpWpLinkRiver');\r\n\t\tthis.dpWpLink = dpWpLink;\r\n\t\tthis.config = dpWpLink.config;\r\n\t\tthis.element = element;\r\n\t\tthis.ul = element.children('ul');\r\n\t\tthis.contentHeight = element.children('#dp_link-selector-height');\r\n\t\tthis.waiting = element.find('.river-waiting');\r\n\t\tthis.init();\r\n\t}\r\n\r\n\r\n\tdelayedCallback(func, delay) {\r\n\t\tlet timeoutTriggered; let funcTriggered; let funcArgs; let\r\n\t\t\tfuncContext;\r\n\r\n\t\tif (!delay) return func;\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tif (funcTriggered) return func.apply(funcContext, funcArgs);\r\n\t\t\t// Otherwise, wait.\r\n\t\t\ttimeoutTriggered = true;\r\n\t\t}, delay);\r\n\r\n\t\treturn function () {\r\n\t\t\tif (timeoutTriggered) return func.apply(this, arguments);\r\n\t\t\t// Otherwise, wait.\r\n\t\t\tfuncArgs = arguments;\r\n\t\t\tfuncContext = this;\r\n\t\t\tfuncTriggered = true;\r\n\t\t};\r\n\t}\r\n\r\n\r\n\tinit() {\r\n\r\n\t\t$.extend(DpWpLinkRiver.prototype, {\r\n\t\t\tposts: {},\r\n\t\t\trefresh() {\r\n\t\t\t\tthis.deselect();\r\n\t\t\t\tthis.visible = this.element.is(':visible');\r\n\t\t\t},\r\n\t\t\tshow() {\r\n\t\t\t\tif (!this.visible) {\r\n\t\t\t\t\tthis.deselect();\r\n\t\t\t\t\tthis.element.show();\r\n\t\t\t\t\tthis.visible = true;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thide() {\r\n\t\t\t\tthis.element.hide();\r\n\t\t\t\tthis.visible = false;\r\n\t\t\t},\r\n\t\t\t// Selects a list item and triggers the river-select event.\r\n\t\t\tselect(li, event) {\r\n\t\t\t\tlet liHeight; let elHeight; let liTop; let\r\n\t\t\t\t\telTop;\r\n\r\n\t\t\t\tif (li.hasClass('unselectable') || li == this.selected) return;\r\n\r\n\t\t\t\tthis.deselect();\r\n\t\t\t\tthis.selected = li.addClass('selected');\r\n\t\t\t\t// Make sure the element is visible.\r\n\t\t\t\tliHeight = li.outerHeight();\r\n\t\t\t\telHeight = this.element.height();\r\n\t\t\t\tliTop = li.position().top;\r\n\t\t\t\telTop = this.element.scrollTop();\r\n\r\n\t\t\t\tif (liTop < 0) // Make first visible element.\r\n\t\t\t\t{ this.element.scrollTop(elTop + liTop); } else if (liTop + liHeight > elHeight) // Make last visible element.\r\n\t\t\t\t{ this.element.scrollTop(elTop + liTop - elHeight + liHeight); }\r\n\r\n\t\t\t\t// Trigger the river-select event.\r\n\t\t\t\tthis.element.trigger('river-select', [li, event, this]);\r\n\t\t\t},\r\n\t\t\tdeselect() {\r\n\t\t\t\tif (this.selected) this.selected.removeClass('selected');\r\n\t\t\t\tthis.selected = false;\r\n\t\t\t},\r\n\t\t\tprev() {\r\n\t\t\t\tif (!this.visible) return;\r\n\r\n\t\t\t\tlet to;\r\n\t\t\t\tif (this.selected) {\r\n\t\t\t\t\tto = this.selected.prev('li');\r\n\t\t\t\t\tif (to.length) this.select(to);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tnext() {\r\n\t\t\t\tif (!this.visible) return;\r\n\r\n\t\t\t\tconst to = this.selected ? this.selected.next('li') : $('li:not(.unselectable):first', this.element);\r\n\t\t\t\tif (to.length) this.select(to);\r\n\t\t\t},\r\n\t\t\tajax(callback) {\r\n\t\t\t\tconst self = this;\r\n\t\t\t\tconst delay = this.query && this.query.page == 1 ? 0 : this.minRiverAJAXDuration;\r\n\t\t\t\tconst waiting = this.dpWpLink.inputs.search.parent().find('.spinner').addClass('is-active');\r\n\t\t\t\tconst response = this.delayedCallback((results, params) => {\r\n\t\t\t\t\tself.process(results, params);\r\n\t\t\t\t\twaiting.removeClass('is-active');\r\n\t\t\t\t\tif (callback) callback(results, params);\r\n\t\t\t\t}, delay);\r\n\t\t\t\tif (this.query) this.query.ajax(response);\r\n\t\t\t},\r\n\t\t\tchange(search) {\r\n\t\t\t\tif (this.query && this._search == search) return;\r\n\t\t\t\tthis.posts = {};\r\n\t\t\t\tthis._search = search;\r\n\t\t\t\tthis.query = new DpWpLinkQuery(search, this.config);\r\n\t\t\t\tthis.element.scrollTop(0);\r\n\t\t\t},\r\n\t\t\tprocess(results, params) {\r\n\t\t\t\tlet list = ''; let alt = true;\r\n\t\t\t\tconst firstPage = params.page == 1;\r\n\r\n\t\t\t\tif (!results) {\r\n\t\t\t\t\tif (firstPage) {\r\n\t\t\t\t\t\tlist += `<li class=\"unselectable no-matches-found\"><span class=\"item-title\"><em>${this.config.noMatchesFound}</em></span></li>`;\r\n\t\t\t\t\t\tthis.ul.html(list);\r\n\t\t\t\t\t} else this.ul.append(list);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst addClass = (!this.dpWpLink.isFirstStep) ? 'dpit-special-link' : 'dpit-special-link dpit-special-link--hidden';\r\n\t\t\t\t\tlist += this.printPostTypeItem({\r\n\t\t\t\t\t\ttitle: this.config.keepPreviousStepUrl,\r\n\t\t\t\t\t\tpermalink: '$keep-prev-step-url',\r\n\t\t\t\t\t\tinfo: this.config.variableLink,\r\n\t\t\t\t\t\tinfoLong: this.config.keepPreviousStepUrlLngInfo,\r\n\t\t\t\t\t}, true, addClass);\r\n\t\t\t\t\tlist += this.printPostTypeItem({\r\n\t\t\t\t\t\ttitle: this.config.keepCurrentUrl,\r\n\t\t\t\t\t\tpermalink: '$keep-current-url',\r\n\t\t\t\t\t\tinfo: this.config.variableLink,\r\n\t\t\t\t\t\tinfoLong: this.config.keepCurrentUrlLngInfo,\r\n\t\t\t\t\t}, true, addClass);\r\n\r\n\t\t\t\t\tconst posts = {};\r\n\t\t\t\t\tconst allowedPostTypes = this.config.allowedPostTypesInPagePostURL;\r\n\t\t\t\t\tconst loadAllPostTypes = allowedPostTypes.includes('all_post_types');\r\n\t\t\t\t\t$.each(results, function () {\r\n\t\t\t\t\t\tif (this.info) {\r\n\t\t\t\t\t\t\tlet type = this.info.toLowerCase();\r\n\t\t\t\t\t\t\tconst isPost = !isNaN(parseInt(type[0]));\r\n\t\t\t\t\t\t\tif (isPost) type = 'post';\r\n\t\t\t\t\t\t\tconst isAllowed = allowedPostTypes.includes(type);\r\n\t\t\t\t\t\t\tif (isAllowed || loadAllPostTypes) {\r\n\t\t\t\t\t\t\t\tif (!posts[type]) posts[type] = [];\r\n\t\t\t\t\t\t\t\tposts[type].push(this);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tObject.keys(posts).forEach((type) => {\r\n\t\t\t\t\t\tif (this.posts[type]) this.posts[type] = [...posts[type], ...this.posts[type]];\r\n\t\t\t\t\t\telse this.posts[type] = posts[type];\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tallowedPostTypes.forEach((type) => {\r\n\t\t\t\t\t\tif (type !== 'all_post_types') {\r\n\t\t\t\t\t\t\tif (this.posts[type]) {\r\n\t\t\t\t\t\t\t\tthis.posts[type].forEach((item) => {\r\n\t\t\t\t\t\t\t\t\tlist += this.printPostTypeItem(item, alt);\r\n\t\t\t\t\t\t\t\t\talt = !alt;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tObject.keys(this.posts).forEach((type) => {\r\n\t\t\t\t\t\t\t\tif (!allowedPostTypes.includes(type) && !this.config.disabledPostTypes.includes(type)) {\r\n\t\t\t\t\t\t\t\t\tthis.posts[type].forEach((item) => {\r\n\t\t\t\t\t\t\t\t\t\tlist += this.printPostTypeItem(item, alt);\r\n\t\t\t\t\t\t\t\t\t\talt = !alt;\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tthis.ul.html(list);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tprintPostTypeItem(item, alt, additionalClass = null) {\r\n\t\t\t\tlet res = '';\r\n\t\t\t\tlet classes = [];\r\n\t\t\t\tif (alt) classes.push('alternate');\r\n\t\t\t\tif (additionalClass) classes.push(additionalClass);\r\n\t\t\t\tif (!item.title) classes.push('no-title');\r\n\r\n\t\t\t\tlet { permalink } = item;\r\n\t\t\t\tif (permalink.startsWith('http://localhost:3000')) {\r\n\t\t\t\t\tpermalink = permalink.replace('http://localhost:3000', this.config.siteUrl);\r\n\t\t\t\t} else if (permalink.startsWith('http://localhost')) {\r\n\t\t\t\t\tpermalink = permalink.replace('http://localhost', this.config.siteUrl);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tclasses = classes.join(' ');\r\n\r\n\t\t\t\tres += classes ? `<li class=\"${classes}\">` : '<li>';\r\n\t\t\t\tres += `<input type=\"hidden\" class=\"item-permalink\" value=\"${permalink}\" />`;\r\n\t\t\t\tres += '<span class=\"item-title\">';\r\n\t\t\t\tres += item.title ? item.title : this.config.noTitle;\r\n\t\t\t\tres += '</span>';\r\n\t\t\t\tres += `<span class=\"item-info\">${item.info}</span>`;\r\n\t\t\t\tif (item.infoLong) {\r\n\t\t\t\t\tres += `<div class=\"item-long-info\">${item.infoLong}</div>`;\r\n\t\t\t\t}\r\n\t\t\t\tres += '</li>';\r\n\t\t\t\treturn res;\r\n\t\t\t},\r\n\t\t\tmaybeLoad() {\r\n\t\t\t\tconst self = this;\r\n\t\t\t\tconst el = this.element;\r\n\t\t\t\tconst bottom = el.scrollTop() + el.height();\r\n\r\n\t\t\t\tif (!this.query.ready() || bottom < this.contentHeight.height() - this.riverBottomThreshold) return;\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tconst newTop = el.scrollTop();\r\n\t\t\t\t\tconst newBottom = newTop + el.height();\r\n\r\n\t\t\t\t\tif (!self.query.ready() || newBottom < self.contentHeight.height() - this.riverBottomThreshold) return;\r\n\r\n\t\t\t\t\tself.waiting.addClass('is-active');\r\n\t\t\t\t\tel.scrollTop(newTop + self.waiting.outerHeight());\r\n\r\n\t\t\t\t\tself.ajax(() => {\r\n\t\t\t\t\t\tself.waiting.removeClass('is-active');\r\n\t\t\t\t\t});\r\n\t\t\t\t}, this.timeToTriggerRiver);\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tthis.refresh();\r\n\r\n\t\t$('#dp_wp-link .query-results, #dp_wp-link #dp_link-selector').scroll(this.maybeLoad.bind(this));\r\n\t\tthis.element.on('click', 'li', (event) => {\r\n\t\t\tthis.select($(event.target).closest('li'), event);\r\n\t\t});\r\n\r\n\t\tthis.change('');\r\n\t}\r\n\r\n\r\n}","import classNames from 'classnames';\r\nimport tippy from 'tippy.js';\r\nimport 'tippy.js/dist/tippy.css';\r\nimport urlJoin from 'url-join';\r\nimport 'tippy.js/themes/material.css';\r\nimport 'tippy.js/animations/scale.css';\r\nimport DPIncUtils from './DPIncUtils';\r\nimport DpWpLinkRiver from './DpWpLinkRiver';\r\n\r\nexport default class DpWpLink {\r\n\r\n\r\n\tkeySensitivity = 100;\r\n\tlastSearch = '';\r\n\tmodalOpen = false;\r\n\r\n\tstartScrollTop = 0;\r\n\tinputs = {};\r\n\trivers = {};\r\n\r\n\tconstructor(config) {\r\n\t\tif (config.dpDebugEn) console.log('DpWpLink');\r\n\t\tthis.config = config;\r\n\t\tthis.unifiedSiteUrl = DPIncUtils.unifyUrl(config.siteUrl, true, true, true, true, true);\r\n\t\tthis.init();\r\n\t}\r\n\r\n\tinit() {\r\n\r\n\t\tthis.inputs.wrap = $('#dp_wp-link-wrap');\r\n\t\tthis.inputs.dialog = $('#dp_wp-link');\r\n\t\tthis.inputs.backdrop = $('#dp_wp-link-backdrop');\r\n\t\tthis.inputs.submit = $('#dp_wp-link-submit');\r\n\t\tthis.inputs.close = $('#dp_wp-link-close');\r\n\r\n\t\t// Input.\r\n\t\tthis.inputs.text = $('#wp-link-text');\r\n\t\tthis.inputs.url = $('#dp_wp-link-url');\r\n\t\tthis.inputs.nonce = $('#_ajax_linking_nonce');\r\n\t\tthis.inputs.openInNewTab = $('#wp-link-target');\r\n\t\tthis.inputs.search = $('#dp_wp-link-search');\r\n\t\tthis.inputs.search.focus();\r\n\r\n\t\t// Build rivers.\r\n\t\tthis.rivers.search = new DpWpLinkRiver($('#dp_search-results'), this);\r\n\t\tthis.rivers.recent = new DpWpLinkRiver($('#dp_most-recent-results'), this);\r\n\t\tthis.rivers.elements = this.inputs.dialog.find('.query-results');\r\n\r\n\t\t// Get search notice text.\r\n\t\tthis.inputs.queryNotice = $('#query-notice-message');\r\n\t\tthis.inputs.queryNoticeTextDefault = this.inputs.queryNotice.find('.query-notice-default');\r\n\t\tthis.inputs.queryNoticeTextHint = this.inputs.queryNotice.find('.query-notice-hint');\r\n\r\n\t\t// Bind event handlers.\r\n\t\tthis.inputs.dialog.keydown(this.keydown.bind(this));\r\n\t\tthis.inputs.dialog.keyup(this.keyup.bind(this));\r\n\t\tthis.inputs.submit.click((event) => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis.update();\r\n\t\t});\r\n\r\n\t\tthis.inputs.close.add(this.inputs.backdrop).add('#dp_wp-link-cancel button').click((event) => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis.close();\r\n\t\t});\r\n\r\n\t\tthis.rivers.elements.on('river-select', this.updateFields.bind(this));\r\n\r\n\t\t// Display 'hint' message when search field or 'query-results' box are focused.\r\n\t\tthis.inputs.search.on('focus.this', () => {\r\n\t\t\tthis.inputs.queryNoticeTextDefault.hide();\r\n\t\t\tthis.inputs.queryNoticeTextHint.removeClass('screen-reader-text').show();\r\n\t\t}).on('blur.this', () => {\r\n\t\t\tthis.inputs.queryNoticeTextDefault.show();\r\n\t\t\tthis.inputs.queryNoticeTextHint.addClass('screen-reader-text').hide();\r\n\t\t});\r\n\r\n\t\tthis.inputs.search.on('keyup input', () => {\r\n\t\t\twindow.clearTimeout(this.searchTimer);\r\n\t\t\tthis.searchTimer = window.setTimeout(() => {\r\n\t\t\t\tthis.searchInternalLinks();\r\n\t\t\t}, 500);\r\n\t\t});\r\n\r\n\t\tthis.inputs.url.on('input', () => {\r\n\t\t\tthis.updateAfterUrlChanged(true);\r\n\t\t});\r\n\r\n\t\tthis.inputs.url.on('paste', () => {\r\n\t\t\tsetTimeout(this.correctURL.bind(this), 0);\r\n\t\t});\r\n\r\n\t\tthis.inputs.url.on('blur', () => { this.correctURL(false); });\r\n\r\n\r\n\t\tif (this.config.loadTippy === true) {\r\n\t\t\t$('.dp-info-icon').load(urlJoin(this.config.assetsUrl, 'icons/info-circle-solid.svg'));\r\n\t\t\t$('.dp-info-icon').each((idx, element) => {\r\n\t\t\t\tconst interactive = $(element).hasClass('dp-info-icon--ia');\r\n\t\t\t\ttippy(element, {\r\n\t\t\t\t\tcontent: (reference) => reference.getAttribute('data-info-text'),\r\n\t\t\t\t\tanimation: 'scale',\r\n\t\t\t\t\ttheme: 'material',\r\n\t\t\t\t\tallowHTML: true,\r\n\t\t\t\t\tinteractive,\r\n\t\t\t\t\tzIndex: 100000003,\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.updateAfterUrlChanged();\r\n\t}\r\n\r\n\tsanitizeUrl(url, removeTrailingSlashes = false) {\r\n\t\tif (!url.startsWith('$')) {\r\n\t\t\tlet regExp = /^\\/+|\\/+$/g;\r\n\t\t\tif (!removeTrailingSlashes) {\r\n\t\t\t\tregExp = /^\\/+/g;\r\n\t\t\t}\r\n\t\t\tif (url.startsWith('/')) {\r\n\t\t\t\t// check multiple leading slashes\r\n\r\n\t\t\t\turl = `/${url.replace(regExp, '')}`;\r\n\t\t\t}\r\n\t\t\tconst unifiedUrl = DPIncUtils.unifyUrl(url, false, false, true, removeTrailingSlashes, true);\r\n\t\t\t// is absolute starting with site url?\r\n\t\t\tif (unifiedUrl.startsWith(this.unifiedSiteUrl)) {\r\n\t\t\t\turl = unifiedUrl.replace(this.unifiedSiteUrl, '');\r\n\t\t\t\tif (!url) url = '/';\r\n\t\t\t} else {\r\n\t\t\t\turl = unifiedUrl;\r\n\t\t\t\t// is not absolute?\r\n\t\t\t\tif (!(/^((http|https|ftp):\\/\\/)/.test(url) || url.startsWith('www.'))) {\r\n\t\t\t\t\t// is relative without leading slash\r\n\t\t\t\t\turl = `/${url.replace(regExp, '')}`;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (url && url.startsWith('/wp-admin')) {\r\n\t\t\t\turl = DPIncUtils.forceQMarkWithoutSlash(url);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn url;\r\n\t}\r\n\r\n\r\n\tactivateSubmitButtonSpinner(activate = true) {\r\n\t\tif (activate) {\r\n\t\t\t$('#dp_wp-link-update .spinner').addClass('is-active');\r\n\t\t\t// $('#dp_wp-link-update #dp_wp-link-submit').fadeOut(700);\r\n\t\t\t$('.dp_wp-link-wrap').addClass('no-pointer-events');\r\n\t\t\t$('#dp_wp-link-update #dp_wp-link-submit').addClass('spinner-bg');\r\n\t\t} else {\r\n\t\t\t$('#dp_wp-link-update .spinner').removeClass('is-active');\r\n\t\t\t$('#dp_wp-link-update #dp_wp-link-submit').removeClass('spinner-bg');\r\n\t\t\t$('.dp_wp-link-wrap').removeClass('no-pointer-events');\r\n\t\t\t// $('#dp_wp-link-update #dp_wp-link-submit').fadeIn(700);\r\n\t\t}\r\n\t}\r\n\r\n\t// If URL wasn't corrected last time and doesn't start with http:, https:, ? # or /, prepend site url.\r\n\tcorrectURL(removeTrailingSlashes = false) {\r\n\t\tconst url = $.trim(this.inputs.url.val());\r\n\t\tif (url && this.correctedURL !== url) {\r\n\t\t\tconst sanitizedUrl = this.sanitizeUrl(url, removeTrailingSlashes);\r\n\t\t\tthis.inputs.url.val(sanitizedUrl);\r\n\t\t\tthis.correctedURL = sanitizedUrl;\r\n\t\t}\r\n\t\tthis.updateAfterUrlChanged();\r\n\t}\r\n\r\n\topen(url, text, openHidden = false, closeAfterSubmit = true, stepIdx = false, enableUrlVarExamples = false, urlVarExamples = null, sysUrlVars = null, jSubEl = null) {\r\n\t\tthis.closeAfterSubmit = closeAfterSubmit;\r\n\t\tthis.isFirstStep = stepIdx === 1;\r\n\t\tthis.enableUrlVarExamples = enableUrlVarExamples;\r\n\t\tthis.sysUrlVars = sysUrlVars;\r\n\t\tthis.jSubEl = jSubEl;\r\n\r\n\t\tif (stepIdx !== false && !isNaN(stepIdx)) {\r\n\t\t\tlet step = DPIncUtils.getNthStr(stepIdx);\r\n\t\t\t$('#dp_link-modal-title').text(this.config.title.replace('%s', step));\r\n\t\t}\r\n\r\n\t\tthis.startScrollTop = document?.documentElement?.scrollTop ?? document?.body?.scrollTop ?? 0;\r\n\r\n\t\tthis.modalOpen = true;\r\n\r\n\t\tif (openHidden) {\r\n\t\t\tthis.inputs.wrap.removeClass('active');\r\n\t\t\tthis.inputs.backdrop.removeClass('active');\r\n\t\t} else {\r\n\t\t\tthis.inputs.wrap.addClass('active');\r\n\t\t\tthis.inputs.backdrop.addClass('active');\r\n\t\t\t$('body').addClass('dp-noscroll');\r\n\t\t}\r\n\r\n\t\tif (!this.isFirstStep) {\r\n\t\t\tthis.urlVars = {};\r\n\t\t\tif (urlVarExamples) {\r\n\t\t\t\tvar sysUrlVarsTmp = sysUrlVars || {};\r\n\t\t\t\tObject.keys(urlVarExamples).forEach((key) => {\r\n\t\t\t\t\tif (!(key in sysUrlVarsTmp)) {\r\n\t\t\t\t\t\tthis.urlVars[key] = urlVarExamples[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t// this.urlVars = urlVarExamples;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.refresh(url, text);\r\n\t\tif (urlVarExamples) {\r\n\t\t\tthis.setUrlExamples(urlVarExamples);\r\n\t\t}\r\n\r\n\t\tif (!this.isFirstStep) {\r\n\t\t\t$('.dpit-special-link').removeClass('dpit-special-link--hidden');\r\n\t\t\t$('#dpwplink-url-vars-1st-step').hide();\r\n\t\t\t$('#dpwplink-url-vars-other-step').show();\r\n\t\t} else {\r\n\t\t\t$('.dpit-special-link').addClass('dpit-special-link--hidden');\r\n\t\t\t$('#dpwplink-url-vars-1st-step').show();\r\n\t\t\t$('#dpwplink-url-vars-other-step').hide();\r\n\t\t}\r\n\t\t$(document).trigger('wplink-open', this.inputs.wrap);\r\n\r\n\r\n\t}\r\n\r\n\trefresh(url, text) {\r\n\t\t// Refresh rivers (clear links, check visibility).\r\n\t\tthis.rivers.search.refresh();\r\n\t\tthis.rivers.recent.refresh();\r\n\r\n\t\t// For the Text editor the \"Link text\" field is always shown.\r\n\t\tif (!this.inputs.wrap.hasClass('has-text-field')) {\r\n\t\t\tthis.inputs.wrap.addClass('has-text-field');\r\n\t\t}\r\n\r\n\t\tthis.inputs.text.val(text);\r\n\t\tthis.setDefaultValues();\r\n\t\tif (url) {\r\n\t\t\tthis.inputs.url.val(url);\r\n\t\t}\r\n\r\n\t\twindow.setTimeout(() => {\r\n\t\t\tif (this.inputs.search && this.inputs.search.length) {\r\n\t\t\t\tthis.inputs.search[0].select();\r\n\t\t\t\tthis.inputs.search.focus();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// Load the most recent results if this is the first time opening the panel.\r\n\t\tif (!this.rivers.recent.ul.children().length) {\r\n\t\t\tthis.rivers.recent.ajax();\r\n\t\t}\r\n\t\tvar val = this.inputs.url.val();\r\n\t\tthis.correctedURL = val ? this.inputs.url.val().replace(/^http:\\/\\//, '') : '';\r\n\t\tthis.updateAfterUrlChanged();\r\n\t}\r\n\r\n\tclose(wasSubmited = false, force = false) {\r\n\t\tif (!wasSubmited || this.closeAfterSubmit || force) {\r\n\t\t\tthis.activateSubmitButtonSpinner(false);\r\n\t\t\tdocument.documentElement.scrollTop = this.startScrollTop;\r\n\t\t\t$('body').removeClass('dp-noscroll');\r\n\t\t\t// $( document.body ).removeClass( 'modal-open' );\r\n\t\t\tthis.modalOpen = false;\r\n\r\n\t\t\tthis.inputs.backdrop.removeClass('active');\r\n\t\t\tthis.inputs.wrap.removeClass('active');\r\n\r\n\t\t\tthis.correctedURL = false;\r\n\r\n\t\t\t$(document).trigger('wplink-close', this.inputs.wrap);\r\n\t\t}\r\n\t\tif (!wasSubmited) {\r\n\t\t\t$(document).trigger('dpwplink-canceled');\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tgetAttrs() {\r\n\t\tthis.correctURL(true);\r\n\t\treturn {\r\n\t\t\thref: $.trim(this.inputs.url.val()),\r\n\t\t\ttarget: this.inputs.openInNewTab.prop('checked') ? '_blank' : null,\r\n\t\t\turlVarExamples: this.getUrlExamples(),\r\n\t\t\tjSubEl: this.jSubEl\r\n\t\t};\r\n\t}\r\n\r\n\tupdate() {\r\n\t\tthis.htmlUpdate();\r\n\t}\r\n\r\n\thtmlUpdate() {\r\n\t\tlet attrs;\r\n\t\tattrs = this.getAttrs();\r\n\t\tconst parser = document.createElement('a');\r\n\t\tparser.href = attrs.href;\r\n\r\n\t\tif (parser.protocol === 'javascript:' || parser.protocol === 'data:') { // jshint ignore:line\r\n\t\t\tattrs.href = '';\r\n\t\t}\r\n\r\n\t\t// If there's no href, return.\r\n\t\tif (!attrs.href) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.close(true);\r\n\t}\r\n\tupdateSubmitButton() {\r\n\t\tif (!this.inputs.url.val()) $('#dp_wp-link-submit').addClass('disabled');\r\n\t\telse $('#dp_wp-link-submit').removeClass('disabled');\r\n\t}\r\n\tupdateVariableUrlsGUI(isOnTypingEvent) {\r\n\t\tconst url = this.inputs.url.val();\r\n\t\tif (this.isVariableUrl(url, true) && this.enableUrlVarExamples) {\r\n\t\t\t$('#search-panel,#wplink-link-existing-content').addClass('dpwplink-inactive-el');\r\n\t\t\t$('#dpwplink-url-vars-wrap').removeClass('dpwplink-inactive-el');\r\n\r\n\t\t\tif (isOnTypingEvent) {\r\n\t\t\t\tif (this.renderUrlVarExTimeout) clearTimeout(this.renderUrlVarExTimeout);\r\n\t\t\t\tthis.renderUrlVarExTimeout = setTimeout(() => {\r\n\t\t\t\t\tthis.renderUrlVarItems(url, this.isFirstStep);\r\n\t\t\t\t}, 10);\r\n\t\t\t} else {\r\n\t\t\t\tthis.renderUrlVarItems(url, this.isFirstStep);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (this.isFirstStep && this.isVariableUrl(url)) {\r\n\t\t\t\tthis.nonActiveUrlVarExamples = {};\r\n\t\t\t\tconst varIds = this.getUrlVarIdsFromUrl(url);\r\n\t\t\t\tif (varIds && varIds.length) {\r\n\t\t\t\t\tvarIds.forEach((id) => {\r\n\t\t\t\t\t\tthis.nonActiveUrlVarExamples[id] = '';\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t$('#dpwplink-url-vars-wrap').addClass('dpwplink-inactive-el');\r\n\t\t\t$('#search-panel,#wplink-link-existing-content').removeClass('dpwplink-inactive-el');\r\n\t\t}\r\n\t}\r\n\tgetUrlVarIdsFromUrl(url, excludeSysVars = true) {\r\n\t\tconst regex = /\\{([^}]+)\\}/g;\r\n\t\tconst matches = [];\r\n\t\tlet match = regex.exec(url);\r\n\t\twhile (match != null) {\r\n\t\t\tmatches.push(match[1]);\r\n\t\t\tmatch = regex.exec(url);\r\n\t\t}\r\n\t\tlet vars = matches.filter((value, index, self) => self.indexOf(value) === index);\r\n\t\tif (excludeSysVars && this.sysUrlVars) {\r\n\t\t\tvars = vars.filter((value) => !Object.keys(this.sysUrlVars).includes(value));\r\n\t\t}\r\n\t\treturn vars;\r\n\t}\r\n\tonUrlVarClick = (event) => {\r\n\t\tlet varId = '';\r\n\t\tif (event.target && event.target.tagName.toLowerCase() === 'span') {\r\n\t\t\tvarId = $(event.target).text();\r\n\t\t} else {\r\n\t\t\tvarId = $(event.target).find('span').text();\r\n\t\t}\r\n\t\tif (varId) {\r\n\t\t\tconst currentVal = this.inputs.url.val();\r\n\t\t\tlet insertAt = -1;\r\n\t\t\tfor (let i = currentVal.length - 1; i >= 0; i--) {\r\n\t\t\t\tif (currentVal.charAt(i) === '}') break;\r\n\t\t\t\telse if (currentVal.charAt(i) === '{') {\r\n\t\t\t\t\tinsertAt = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (insertAt >= 0) {\r\n\t\t\t\tthis.inputs.url.val(currentVal.slice(0, insertAt) + varId);\r\n\t\t\t} else this.inputs.url.val(currentVal + varId);\r\n\t\t\tthis.inputs.url.focus();\r\n\t\t}\r\n\t\t// console.log(varId);\r\n\t}\r\n\trenderUrlVarItems(url, isFirstStep) {\r\n\t\tlet urlVars = this.urlVars ? Object.keys(this.urlVars) : [];\r\n\t\tif (isFirstStep) {\r\n\t\t\turlVars = this.getUrlVarIdsFromUrl(url) || [];\r\n\t\t\t$('#dpwplink-url-vars-hint-next-steps').hide();\r\n\t\t\tif (!urlVars.length) { $('#dpwplink-url-vars-hint-1st-step').show(); $('#dpwplink-url-vars-hint-1st-step-fill').hide(); }\r\n\t\t\telse { $('#dpwplink-url-vars-hint-1st-step').hide(); $('#dpwplink-url-vars-hint-1st-step-fill').show(); }\r\n\t\t}\r\n\t\telse {\r\n\t\t\t$('#dpwplink-url-vars-hint-1st-step').hide();\r\n\t\t\t$('#dpwplink-url-vars-hint-1st-step-fill').hide();\r\n\t\t\tif (!urlVars.length) $('#dpwplink-url-vars-hint-next-steps').show();\r\n\t\t\telse $('#dpwplink-url-vars-hint-next-steps').hide();\r\n\t\t}\r\n\t\tlet sysUrlVarsLength = 0;\r\n\t\tif (this.sysUrlVars) {\r\n\t\t\tObject.keys(this.sysUrlVars).forEach((id) => {\r\n\t\t\t\turlVars.unshift(id);\r\n\t\t\t\tsysUrlVarsLength++;\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (urlVars) {\r\n\t\t\t$('.dpwplink-url-vars__item--id-only').off('click', this.onUrlVarClick);\r\n\t\t\turlVars.forEach((varId, idx) => {\r\n\t\t\t\tconst isSystemVar = idx < sysUrlVarsLength;\r\n\t\t\t\tconst idAndVal = isFirstStep && !isSystemVar;\r\n\t\t\t\tconst jUrlVarItem = $(`.dpwplink-url-vars__item[data-idx=\"${idx}\"]`);\r\n\t\t\t\tif (!jUrlVarItem.length) {\r\n\t\t\t\t\t$(isSystemVar ? '#dpwplink-sys-url-vars' : '#dpwplink-url-vars').append(this.getUrlVarExampleHtml(idx, varId, isFirstStep, isSystemVar));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tjUrlVarItem.find('span').text(`{${varId}}`);\r\n\t\t\t\t\tjUrlVarItem.attr('data-var-id', varId);\r\n\t\t\t\t\tjUrlVarItem.removeClass('dpwplink-url-vars__item--inactive').show();\r\n\t\t\t\t\tif (idAndVal) jUrlVarItem.removeClass('dpwplink-url-vars__item--id-only');\r\n\t\t\t\t\telse jUrlVarItem.addClass('dpwplink-url-vars__item--id-only');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$('.dpwplink-url-vars__item--id-only').on('click', this.onUrlVarClick);\r\n\t\t\tlet idx = urlVars.length;\r\n\t\t\tdo {\r\n\t\t\t\tvar jNextItem = $(`.dpwplink-url-vars__item[data-idx=\"${idx}\"]`);\r\n\t\t\t\tjNextItem.addClass('dpwplink-url-vars__item--inactive').hide();\r\n\t\t\t\tidx++;\r\n\t\t\t}\r\n\t\t\twhile (jNextItem.length);\r\n\t\t}\r\n\t}\r\n\tgetUrlExamples() {\r\n\t\tif (!this.isFirstStep) return null;\r\n\t\tif (!this.enableUrlVarExamples) return this.nonActiveUrlVarExamples;\r\n\r\n\t\tconst getCustomVariables = this.isVariableUrl(this.inputs.url.val(), true) && this.enableUrlVarExamples;\r\n\r\n\t\tif (getCustomVariables) {\r\n\t\t\tconst res = {};\r\n\t\t\t$('.dpwplink-url-vars__item:not(.dpwplink-url-vars__item--inactive)').each((idx, element) => {\r\n\t\t\t\tconst id = $(element).data('var-id');\r\n\t\t\t\tif (id) {\r\n\t\t\t\t\tif ($(element).hasClass('dpwplink-url-vars__item--system') && this.sysUrlVars) res[id] = this.sysUrlVars[id];\r\n\t\t\t\t\telse if (getCustomVariables) res[id] = $(element).find('input').val();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\telse return this.sysUrlVars;\r\n\r\n\t}\r\n\tsetUrlExamples(urlExamples) {\r\n\t\tif (!this.enableUrlVarExamples || !this.isFirstStep) return null;\r\n\t\tif (!urlExamples) urlExamples = {};\r\n\t\tObject.keys(urlExamples).forEach((varId) => {\r\n\t\t\t$(`.dpwplink-url-vars__item[data-var-id=\"${varId}\"]`).find('input').val(urlExamples[varId]);\r\n\t\t});\r\n\t}\r\n\tgetUrlVarExampleHtml(idx, name, isFirstStep, isSystem = false) {\r\n\t\tconst itemClass = classNames({\r\n\t\t\t'dpwplink-url-vars__item': true,\r\n\t\t\t'dpwplink-url-vars__item--id-only': !isFirstStep || isSystem,\r\n\t\t\t'dpwplink-url-vars__item--system': isSystem,\r\n\t\t});\r\n\t\treturn `<li class=\"${itemClass}\" data-idx=\"${idx}\" data-var-id=\"${name}\"><span>{${name}}</span><input></li>`;\r\n\t}\r\n\tupdateAfterUrlChanged(isOnTypingEvent = false) {\r\n\t\tthis.updateSubmitButton();\r\n\t\tthis.updateVariableUrlsGUI(isOnTypingEvent);\r\n\t}\r\n\tisVariableUrl(url, beginIsEnough = false) {\r\n\t\tif (!url) return false;\r\n\t\tconst start = url.indexOf('{');\r\n\t\tif (beginIsEnough && start >= 0) return true;\r\n\t\tconst stop = url.indexOf('}');\r\n\t\treturn start >= 0 && stop > start;\r\n\t}\r\n\tupdateFields(e, li) {\r\n\t\tif (li.length) {\r\n\t\t\tconst url = li.children('.item-permalink').val();\r\n\t\t\tthis.inputs.url.val(this.sanitizeUrl(url, true));\r\n\t\t\tthis.updateAfterUrlChanged();\r\n\t\t\tif (this.inputs.wrap.hasClass('has-text-field') && !this.inputs.text.val()) {\r\n\t\t\t\tthis.inputs.text.val($(li[0]).children('.item-title').text());\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tsetDefaultValues() {\r\n\t\tthis.inputs.url.val('');\r\n\t\tthis.updateAfterUrlChanged();\r\n\t\t// Empty the search field and swap the \"rivers\".\r\n\t\tthis.inputs.search.val('');\r\n\t\tthis.searchInternalLinks();\r\n\r\n\t\t// Update save prompt.\r\n\t\tthis.inputs.submit.val(this.config.save);\r\n\t}\r\n\r\n\tsearchInternalLinks() {\r\n\t\tlet waiting;\r\n\t\tconst search = this.inputs.search.val() || '';\r\n\t\tconst minInputLength = parseInt(this.config.minInputLength, 10) || 3;\r\n\r\n\t\tif (search.length >= minInputLength) {\r\n\t\t\tthis.rivers.recent.hide();\r\n\t\t\tthis.rivers.search.show();\r\n\r\n\t\t\t// Don't search if the keypress didn't change the title.\r\n\t\t\tif (this.lastSearch == search) return;\r\n\r\n\t\t\tthis.lastSearch = search;\r\n\t\t\twaiting = this.inputs.search.parent().find('.spinner').addClass('is-active');\r\n\r\n\t\t\tthis.rivers.search.change(search);\r\n\t\t\tthis.rivers.search.ajax(() => {\r\n\t\t\t\twaiting.removeClass('is-active');\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.rivers.search.hide();\r\n\t\t\tthis.rivers.recent.show();\r\n\t\t}\r\n\t}\r\n\r\n\tnext() {\r\n\t\tthis.rivers.search.next();\r\n\t\tthis.rivers.recent.next();\r\n\t}\r\n\r\n\tprev() {\r\n\t\tthis.rivers.search.prev();\r\n\t\tthis.rivers.recent.prev();\r\n\t}\r\n\r\n\tkeydown(event) {\r\n\t\tif (this.modalOpen) {\r\n\t\t\tlet fn; let\r\n\t\t\t\tid;\r\n\r\n\t\t\t// Escape key.\r\n\t\t\tif (event.keyCode === 27) {\r\n\t\t\t\t$('#dp_wp-link-close').trigger('click');\r\n\t\t\t\t//this.close();\r\n\t\t\t\tevent.stopImmediatePropagation();\r\n\t\t\t\t// Tab key.\r\n\t\t\t} else if (event.keyCode === 9) {\r\n\t\t\t\tid = event.target.id;\r\n\r\n\t\t\t\t// dp_wp-link-submit must always be the last focusable element in the dialog.\r\n\t\t\t\t// Following focusable elements will be skipped on keyboard navigation.\r\n\t\t\t\tif (id === 'dp_wp-link-submit' && !event.shiftKey) {\r\n\t\t\t\t\tthis.inputs.close.focus();\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t} else if (id === 'dp_wp-link-close' && event.shiftKey) {\r\n\t\t\t\t\tthis.inputs.submit.focus();\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Up Arrow and Down Arrow keys.\r\n\t\t\tif (event.shiftKey || (event.keyCode !== 38 && event.keyCode !== 40)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (document.activeElement\r\n\t\t\t\t&& (document.activeElement.id === 'link-title-field' || document.activeElement.id === 'url-field')) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Up Arrow key.\r\n\t\t\tfn = event.keyCode === 38 ? 'prev' : 'next';\r\n\t\t\tclearInterval(this.keyInterval);\r\n\t\t\tthis[fn]();\r\n\t\t\tthis.keyInterval = setInterval(this[fn], this.keySensitivity);\r\n\t\t\tevent.preventDefault();\r\n\t\t}\r\n\t}\r\n\r\n\tkeyup(event) {\r\n\t\t// Up Arrow and Down Arrow keys.\r\n\t\tif (event.keyCode === 38 || event.keyCode === 40) {\r\n\t\t\tclearInterval(this.keyInterval);\r\n\t\t\tevent.preventDefault();\r\n\t\t}\r\n\t}\r\n}","import replaceString from 'replace-string';\r\nimport urlJoin from 'url-join';\r\n\r\nexport default class DPIncUtils {\r\n\tconstructor(config) {\r\n\t\tif (config.dpDebugEn) console.log('DPIncUtils');\r\n\t}\r\n\r\n\tstatic isVariableUrl(url) {\r\n\t\tconst start = url.indexOf('{');\r\n\t\tconst stop = url.indexOf('}');\r\n\t\treturn start >= 0 && stop > start;\r\n\t}\r\n\r\n\tstatic fillUrlVariables(urlVars, url) {\r\n\t\tif (urlVars && url) {\r\n\t\t\tObject.keys(urlVars).forEach((varId) => {\r\n\t\t\t\turl = replaceString(url, `{${varId}}`, urlVars[varId]);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn url;\r\n\t}\r\n\r\n\tstatic simpleObjectToStr(obj, separator = '|', valueNameSeparator = '=') {\r\n\t\tlet res = '';\r\n\t\tif (obj) {\r\n\t\t\tObject.keys(obj).forEach((key, idx) => {\r\n\t\t\t\tif (idx != 0) res += separator;\r\n\t\t\t\tres += `${key}${valueNameSeparator}${obj[key]}`;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\r\n\tstatic strToSimpleObject(str, separator = '|', valueNameSeparator = '=') {\r\n\t\tconst res = {};\r\n\t\tif (str) {\r\n\t\t\tconst items = str.split(separator);\r\n\t\t\tif (items) {\r\n\t\t\t\titems.forEach((item) => {\r\n\t\t\t\t\tconst parts = item.split(valueNameSeparator);\r\n\t\t\t\t\tif (parts && parts.length >= 2) {\r\n\t\t\t\t\t\tres[parts[0]] = parts[1];\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\r\n\tstatic getInfoIconHtml(className, text, title = '') {\r\n\t\tif (title) text = `<strong class=\"info-tip-title\">${title}</strong>${text}`;\r\n\t\treturn $(`<div class=\"${className}\"></div>`).attr('data-info-text', text);\r\n\t}\r\n\r\n\tstatic strLastPart(text, delimiter = '.', def = '') {\r\n\t\tconst dataParts = text.split(delimiter);\r\n\t\tif (dataParts && dataParts.length > 0) {\r\n\t\t\treturn dataParts[dataParts.length - 1];\r\n\t\t}\r\n\t\treturn def;\r\n\t}\r\n\r\n\tstatic strFirstPart(text, delimiter = '.', def = '') {\r\n\t\tconst dataParts = text.split(delimiter);\r\n\t\tif (dataParts && dataParts.length > 0) {\r\n\t\t\treturn dataParts[0];\r\n\t\t}\r\n\t\treturn def;\r\n\t}\r\n\r\n\tstatic rightTrimByString(url, delimiter = '.') {\r\n\r\n\t\tconst pos = url.indexOf(delimiter);\r\n\t\tif (pos >= 0) {\r\n\t\t\treturn url.substring(0, pos);\r\n\t\t}\r\n\t\treturn url;\r\n\t}\r\n\r\n\tstatic filterQMarkWithNoSlash(url) {\r\n\t\tconst qMarkIdx = url.indexOf('?');\r\n\t\tif (qMarkIdx >= 0) {\r\n\t\t\tif (qMarkIdx === 0 || url[qMarkIdx - 1] != '/') {\r\n\t\t\t\turl = `${url.substring(0, qMarkIdx)}/${url.substring(qMarkIdx)}`;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn url;\r\n\t}\r\n\r\n\tstatic forceQMarkWithoutSlash(url) {\r\n\t\tconst qMarkIdx = url.indexOf('?');\r\n\t\tif (qMarkIdx > 0 && url[qMarkIdx - 1] == '/') {\r\n\t\t\turl = url.substring(0, qMarkIdx - 1) + url.substring(qMarkIdx);\r\n\t\t}\r\n\t\treturn url;\r\n\t}\r\n\r\n\tstatic sanitizePossibleRelativeUrl(url, mainSiteUrl, forceSlashBeforeQMark = false) {\r\n\t\tif (url.startsWith('/')) {\r\n\t\t\turl = urlJoin(mainSiteUrl, url);\r\n\t\t\tif (forceSlashBeforeQMark) {\r\n\t\t\t\turl = DPIncUtils.filterQMarkWithNoSlash(url);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn url;\r\n\t}\r\n\r\n\tstatic absToRelativeUrl(url, mainSiteUrl) {\r\n\t\tif (mainSiteUrl && url.startsWith(mainSiteUrl)) {\r\n\t\t\turl = url.substring(mainSiteUrl.length);\r\n\t\t\tif (!url.startsWith('/')) url = `/${url}`;\r\n\t\t}\r\n\t\treturn url;\r\n\t}\r\n\r\n\tstatic removeURLParameter(url, parameter) {\r\n\t\t// prefer to use l.search if you have a location/link object\r\n\t\tconst urlparts = url.split('?');\r\n\t\tif (urlparts.length >= 2) {\r\n\t\t\tconst prefix = `${encodeURIComponent(parameter)}=`;\r\n\t\t\tconst pars = urlparts[1].split(/[&;]/g);\r\n\r\n\t\t\t// reverse iteration as may be destructive\r\n\t\t\tfor (let i = pars.length; i-- > 0;) {\r\n\t\t\t\t// idiom for string.startsWith\r\n\t\t\t\tif (pars[i].lastIndexOf(prefix, 0) !== -1) {\r\n\t\t\t\t\tpars.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn urlparts[0] + (pars.length > 0 ? `?${pars.join('&')}` : '');\r\n\t\t}\r\n\t\treturn url;\r\n\t}\r\n\r\n\tstatic removeURLParameters(url, parameters) {\r\n\t\tlet paramKeys = parameters;\r\n\t\tif (!Array.isArray(parameters)) paramKeys = Object.keys(parameters);\r\n\t\tparamKeys.forEach((parameter) => {\r\n\t\t\turl = DPIncUtils.removeURLParameter(url, DPIncUtils.getDpUrlParamName(parameter, parameters));\r\n\t\t});\r\n\t\treturn url;\r\n\t}\r\n\r\n\tstatic unifyUrl(url, removeQuery = true, forceSlashBeforeQMark = false, removeHash = true, removeTrailingSlashes = true, prependSlash = false) {\r\n\t\tif (url) {\r\n\t\t\turl = DPIncUtils.strLastPart(url, '://', url);\r\n\t\t\tif (url && url.startsWith('www.')) url = url.substring(4);\r\n\t\t\tif (url && removeHash) url = DPIncUtils.strFirstPart(url, '#', url);\r\n\t\t\tif (url && removeQuery) {\r\n\t\t\t\turl = DPIncUtils.strFirstPart(url, '?', url);\r\n\t\t\t} else if (forceSlashBeforeQMark) {\r\n\t\t\t\turl = DPIncUtils.filterQMarkWithNoSlash(url);\r\n\t\t\t}\r\n\t\t\tif (url) {\r\n\t\t\t\tlet regExp = /\\/+$/;\r\n\t\t\t\tif (!removeTrailingSlashes) {\r\n\t\t\t\t\tregExp = /^\\/+/g;\r\n\t\t\t\t}\r\n\t\t\t\turl = url.replace(regExp, '');\r\n\t\t\t}\r\n\t\t\tif (url && prependSlash) {\r\n\t\t\t\turl = `/${url}`;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!url) {\r\n\t\t\turl = '/';\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (url.endsWith('/index.php')) {\r\n\t\t\t\turl = DPIncUtils.rightTrimByString(url, '/index.php');\r\n\t\t\t\t//$url = Str::separed_supplement_of_last_part( $url, '/index.php', $url );\r\n\t\t\t} else if (!removeQuery) {\r\n\t\t\t\turl = replaceString(url, '/index.php/?', '/');\r\n\t\t\t\tif (!forceSlashBeforeQMark) {\r\n\t\t\t\t\turl = replaceString(url, '/index.php?', '/');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn url;\r\n\t}\r\n\r\n\tstatic getDpUrlParamName(id, queryParamsDefinitions) {\r\n\t\tlet res = id;\r\n\t\tif (queryParamsDefinitions) res = queryParamsDefinitions[id];\r\n\t\treturn res;\r\n\t}\r\n\r\n\tstatic getDpUrlParam(id, queryParamsDefinitions, currentUrl = null, defVal = null) {\r\n\t\tlet res = defVal;\r\n\t\tconst key = DPIncUtils.getDpUrlParamName(id, queryParamsDefinitions);\r\n\t\tif (key) {\r\n\t\t\tif (!currentUrl) currentUrl = new URL(window.location);\r\n\t\t\tres = currentUrl.searchParams.get(key);\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\r\n\tstatic setDpUrlParam(id, queryParamsDefinitions, val, postfixAmpersand = true) {\r\n\t\tlet res = '';\r\n\t\tconst key = DPIncUtils.getDpUrlParamName(id, queryParamsDefinitions);\r\n\t\tif (key) {\r\n\t\t\tres = key + '=' + val;\r\n\t\t\tif (postfixAmpersand) res += '&';\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\r\n\tstatic buildDpQueryString(params, queryParamsDefinitions, prefix = '?', unmappedParams = null) {\r\n\t\tlet res = prefix;\r\n\t\tif (unmappedParams) {\r\n\t\t\tconst idsUm = Object.keys(unmappedParams);\r\n\t\t\tidsUm.forEach((id) => {\r\n\t\t\t\tif (unmappedParams[id] !== null && unmappedParams[id] !== undefined && unmappedParams[id] !== '')\r\n\t\t\t\t\tres += id + '=' + unmappedParams[id] + '&';\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (params) {\r\n\t\t\tconst ids = Object.keys(params);\r\n\t\t\tids.forEach((id) => {\r\n\t\t\t\tif (params[id] !== null && params[id] !== undefined && params[id] !== '')\r\n\t\t\t\t\tres += DPIncUtils.setDpUrlParam(id, queryParamsDefinitions, params[id]);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (res && res[res.length - 1] == '&') res = res.substr(0, res.length - 1);\r\n\t\tif (res == prefix) res = '';\r\n\t\treturn res;\r\n\t}\r\n\r\n\tstatic decodeStepParamAdvancedVal(value, paramName, stepDefs, mainValOnlyForSimpleVal = true, onlyValForExtProps = false) {\r\n\t\tconst stepDef = stepDefs?.[paramName];\r\n\t\tconst extCfg = stepDef?.ext;\r\n\t\tlet res = {\r\n\t\t\tval: value ?? stepDef?.defMain,\r\n\t\t\text: {}\r\n\t\t};\r\n\t\tif (value?.startsWith('base64__') || extCfg) {\r\n\t\t\tlet dataObj = null;\r\n\t\t\tif (value?.startsWith('base64__')) {\r\n\t\t\t\tconst dataObjStr = atob(value.substr(8));\r\n\t\t\t\tdataObj = dataObjStr ? JSON.parse(dataObjStr) : null;\r\n\t\t\t\tres.val = dataObj?.val ?? stepDef?.defMain;\r\n\t\t\t}\r\n\t\t\tif (extCfg) {\r\n\t\t\t\tObject.keys(extCfg).forEach(id => {\r\n\t\t\t\t\tif (onlyValForExtProps) {\r\n\t\t\t\t\t\tres.ext[id] = dataObj?.ext?.[id] ?? extCfg[id]?.def;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tres.ext[id] = {\r\n\t\t\t\t\t\t\t...extCfg[id],\r\n\t\t\t\t\t\t\tval: dataObj?.ext?.[id] ?? extCfg[id]?.def\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t} else if (mainValOnlyForSimpleVal) {\r\n\t\t\tres = value;\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\r\n\tstatic encodeStepParamAdvancedVal(value, paramName, stepDefs) {\r\n\t\tconst extCfg = stepDefs?.[paramName]?.ext;\r\n\t\treturn extCfg ? 'base64__' + btoa(JSON.stringify(value)) : value;\r\n\t}\r\n\r\n\tstatic initStepParams(stepDefinitions) {\r\n\t\tconst res = {};\r\n\t\tObject.keys(stepDefinitions).forEach(paramName => {\r\n\t\t\tlet mainVal = '';\r\n\t\t\tif (stepDefinitions[paramName]) {\r\n\t\t\t\tmainVal = stepDefinitions[paramName].def || '';\r\n\t\t\t\tif (stepDefinitions[paramName].ext) {\r\n\t\t\t\t\tlet extVals = {};\r\n\t\t\t\t\tObject.keys(stepDefinitions[paramName].ext).forEach(extName => {\r\n\t\t\t\t\t\textVals[extName] = stepDefinitions[paramName].ext[extName].def;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tmainVal = {\r\n\t\t\t\t\t\tval: mainVal,\r\n\t\t\t\t\t\text: extVals\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tres[paramName] = mainVal;\r\n\t\t});\r\n\t\treturn res;\r\n\t}\r\n\r\n\tstatic getNthStr(idx, supEnabled = false) {\r\n\t\tif (idx !== false && !isNaN(idx)) {\r\n\t\t\tlet supStart = '';\r\n\t\t\tlet supEnd = '';\r\n\t\t\tif (supEnabled) {\r\n\t\t\t\tsupStart = '<sup>';\r\n\t\t\t\tsupEnd = '</sup>';\r\n\t\t\t}\r\n\t\t\tlet res = '';\r\n\t\t\tswitch (idx) {\r\n\t\t\t\tcase 1: res = `1${supStart}st${supEnd}`; break;\r\n\t\t\t\tcase 2: res = `2${supStart}nd${supEnd}`; break;\r\n\t\t\t\tcase 3: res = `3${supStart}rd${supEnd}`; break;\r\n\t\t\t\tdefault: res = `${idx}${supStart}th${supEnd}`; break;\r\n\t\t\t}\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\r\n\tstatic textStylesIsHOrPOption($key) {\r\n\t\treturn $key.length >= 3 && ($key[0] === 'p' && $key[1] === '_' || $key[0] === 'h' && $key[2] === '_');\r\n\t}\r\n\r\n\tstatic textStylesIsFontFamilyVal($key) {\r\n\t\treturn ['p_font', 'h_font', 'btn_font'].includes($key);\r\n\t}\r\n\r\n\tstatic setMobileSizeCoef(rootDivEl, textStylesCfg, mobileBreakPoint = -1) {\r\n\t\tif (textStylesCfg) {\r\n\t\t\tconst mobSizeCoef = (mobileBreakPoint > 0 && ($(window).width() <= mobileBreakPoint || $(window).height() <= mobileBreakPoint)) ? textStylesCfg.mobile_size_coef / 100 : 1;\r\n\t\t\trootDivEl.style.setProperty('--font-size-coef', mobSizeCoef * textStylesCfg.all_in_1_size_coef / 100);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic setTextStyles(rootDivEl, textStylesCfg, mobileBreakPoint = -1) {\r\n\r\n\r\n\t\tif (textStylesCfg && rootDivEl /*&& textStylesCfg.see_advanced_text_styles*/) {\r\n\t\t\tDPIncUtils.setMobileSizeCoef(rootDivEl, textStylesCfg, mobileBreakPoint);\r\n\t\t\tconst text_styles = { ...textStylesCfg };\r\n\t\t\tconst font_size_unit = text_styles.font_size_unit ?? 'em';\r\n\t\t\tconst cssVariables = [];\r\n\r\n\t\t\tObject.keys(text_styles).forEach(propName => {\r\n\t\t\t\tif (this.textStylesIsFontFamilyVal(propName)) {\r\n\t\t\t\t\tcssVariables[`--${propName}`] = (text_styles[propName] || text_styles[propName] == '0') ? text_styles[propName] : 'inherit';\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tif (text_styles.p_font_size || text_styles.p_font_size === '0') {\r\n\t\t\t\tcssVariables['--p_font_size'] = 'calc(' + text_styles.p_font_size + font_size_unit + '*var(--font-size-coef))';\r\n\t\t\t\tif (text_styles.p_mb || text_styles.p_mb === '0') {\r\n\t\t\t\t\tcssVariables['--p_mb'] = 'calc(' + (text_styles.p_mb / 100) + '*' + cssVariables['--p_font_size'] + ')';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (text_styles.h2_font_size || text_styles.h2_font_size == 0 && text_styles.h5_font_size || text_styles.h5_font_size == 0) {\r\n\t\t\t\tconst unit = (text_styles.h2_font_size - text_styles.h5_font_size) / 4;\r\n\t\t\t\tfor (let i = 1; i <= 6; i++) {\r\n\t\t\t\t\tconst unitCnt = i - 2;\r\n\t\t\t\t\tcssVariables[`--h${i}_font_size`] = 'calc(' + (text_styles.h2_font_size - unitCnt * unit) + font_size_unit + '*var(--font-size-coef))';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (text_styles.h2_mb || text_styles.h2_mb == 0 && text_styles.h5_mb || text_styles.h5_mb == 0) {\r\n\t\t\t\tconst unit = (text_styles.h2_mb - text_styles.h5_mb) / 4;\r\n\t\t\t\tfor (let i = 1; i <= 6; i++) {\r\n\t\t\t\t\tconst unitCnt = i - 2;\r\n\t\t\t\t\tconst percentVal = Math.round(10 * (text_styles.h2_mb - unitCnt * unit)) / 10;\r\n\t\t\t\t\tcssVariables[`--h${i}_mb`] = 'calc(' + (percentVal / 100) + '*' + cssVariables[`--h${i}_font_size`] + ')';\r\n\t\t\t\t\tif (i === 2) cssVariables['--dp_unit'] = 'calc(' + (percentVal * 1.3 /*lineheight*/ / 1000 /* smaller unit */) + '*' + cssVariables[`--h${i}_font_size`] + ')';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tObject.keys(cssVariables).forEach(propName => {\r\n\t\t\t\trootDivEl.style.setProperty(propName, cssVariables[propName]);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tstatic loadBuilder = (mainCfg, instanceCreatorFce) => {\r\n\t\tif (mainCfg.dpDebugEn) console.log('builder config:', mainCfg);\r\n\t\tconst currentUrl = new URL(window.location);\r\n\t\tconst queryParamsDefs = mainCfg.queryParamsDefs;\r\n\t\tconst tourId = DPIncUtils.getDpUrlParam('dp_qp_tour_id', queryParamsDefs, currentUrl);\r\n\t\tconst createNew = DPIncUtils.getDpUrlParam('dp_qpb_create_new', queryParamsDefs, currentUrl);\r\n\t\tconst builderMode = DPIncUtils.getDpUrlParam('dp_qpb_builder_mode', queryParamsDefs, currentUrl);\r\n\t\tif ((mainCfg.tours && mainCfg.tours.length) || builderMode === '3') {\r\n\t\t\tconst mainCfgProcessed = { ...mainCfg };\r\n\t\t\tdelete mainCfgProcessed.tours;\r\n\t\t\tmainCfgProcessed.builderOrigin = DPIncUtils.getDpUrlParam('dp_qpb_builder_origin', queryParamsDefs, currentUrl);\r\n\t\t\tmainCfgProcessed.builderMode = builderMode;\r\n\t\t\tmainCfgProcessed.originHashId = DPIncUtils.getDpUrlParam('dp_qpb_origin_el_id', queryParamsDefs, currentUrl);\r\n\t\t\tmainCfgProcessed.triggerId = DPIncUtils.getDpUrlParam('dp_qp_trigger_id', queryParamsDefs, currentUrl) || 0;\r\n\t\t\tmainCfgProcessed.initState = DPIncUtils.getDpUrlParam('dp_qpb_init_state', queryParamsDefs, currentUrl);\r\n\t\t\tmainCfgProcessed.inNewWindow = DPIncUtils.getDpUrlParam('dp_qpb_in_new_window', queryParamsDefs, currentUrl) === '1';\r\n\t\t\tmainCfgProcessed.mobileAltStepMode = DPIncUtils.getDpUrlParam('dp_qpb_mobile_alt_step_mode', queryParamsDefs, currentUrl);\r\n\t\t\tconst delay = mainCfgProcessed.mobileAltStepMode === 'mobile_menu' ? 500 : 0;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (builderMode === '3') {\r\n\t\t\t\t\tinstanceCreatorFce(mainCfgProcessed, null);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmainCfg.tours.forEach((tourCfg) => {\r\n\t\t\t\t\t\tif ((createNew && tourCfg.createNew) || tourCfg.tourId == tourId) {\r\n\t\t\t\t\t\t\tinstanceCreatorFce(mainCfgProcessed, tourCfg);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}, delay);\r\n\t\t}\r\n\t};\r\n}\r\n"],"sourceRoot":""}